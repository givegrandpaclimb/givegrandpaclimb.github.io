import{v as vModelText,w as withKeys,c as withModifiers,d as vShow,b as vModelSelect,f as vModelCheckbox}from"./vendor-vue-runtime-dom-BMMAYnUe.js";import{E as Editor,M as MdPreview}from"./vendor-md-editor-v3-CRlTClKG.js";import{_ as _export_sfc,g as generationConfig,F as FunctionType,R as Router,U as Utils,s as systemInstruction,G as Gemini,D as Database,C as CloudFlare,a as studioStatus}from"../1758589001436.js";import{d as defineComponent,k as createElementBlock,m as openBlock,q as createBaseVNode,F as Fragment,s as renderList,r as withDirectives,t as createBlock,l as createCommentVNode,w as watch,o as onMounted,b as createVNode,x as createStaticVNode,y as createTextVNode}from"./vendor-vue-runtime-core-CNwC6-JB.js";import{K as toDisplayString,s as normalizeStyle,q as normalizeClass}from"./vendor-vue-shared-ByV9YylJ.js";import{a as ref,y as unref,r as reactive,d as isRef}from"./vendor-vue-reactivity-pQI8TCyu.js";const _hoisted_1$a={style:{"background-color":"rgba(0,0,0,0.5)","z-index":"100",width:"100vw",height:"100vh",position:"fixed",left:"0",top:"0",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",gap:"24px"}},_hoisted_2$4={style:{border:"1px white solid",width:"max(80vw, 420px)","background-color":"#111"}},_hoisted_3$4={style:{height:"80vh"}},_hoisted_4$4=["onUpdate:modelValue"],_hoisted_5$4=["onUpdate:modelValue"],_hoisted_6$4=["onClick"],_hoisted_7$4={style:{display:"flex",gap:"24px"}},_sfc_main$c=defineComponent({__name:"FilterWindow",props:{list:{}},emits:["close"],setup(e,{emit:t}){const o=t;return(e,t)=>(openBlock(),createElementBlock("div",_hoisted_1$a,[createBaseVNode("table",_hoisted_2$4,[t[3]||(t[3]=createBaseVNode("thead",{style:{width:"calc(100% - 14px)"}},[createBaseVNode("tr",{style:{width:"100%"}},[createBaseVNode("th",null,"显示"),createBaseVNode("th",null,"原文"),createBaseVNode("th")])],-1)),createBaseVNode("tbody",_hoisted_3$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.list,(o,a)=>(openBlock(),createElementBlock("tr",{key:a},[createBaseVNode("td",null,[withDirectives(createBaseVNode("input",{type:"text","onUpdate:modelValue":e=>o[0]=e},null,8,_hoisted_4$4),[[vModelText,o[0]]])]),createBaseVNode("td",null,[withDirectives(createBaseVNode("input",{type:"text","onUpdate:modelValue":e=>o[1]=e,onKeydown:t[0]||(t[0]=withKeys(withModifiers(t=>e.list.push(["",""]),["stop"]),["enter"]))},null,40,_hoisted_5$4),[[vModelText,o[1]]])]),createBaseVNode("td",null,[createBaseVNode("button",{style:{"background-color":"#d00000"},onClick:t=>e.list.splice(a,1)},"删除",8,_hoisted_6$4)])]))),128))])]),createBaseVNode("div",_hoisted_7$4,[createBaseVNode("button",{style:{"background-color":"#0080ff"},onClick:t[1]||(t[1]=t=>e.list.push(["",""]))},"添加一行"),createBaseVNode("button",{style:{"background-color":"#0080ff"},onClick:t[2]||(t[2]=e=>o("close"))},"完成")])]))}}),FilterWindow=_export_sfc(_sfc_main$c,[["__scopeId","data-v-7e274b1b"]]),_hoisted_1$9={style:{"background-color":"rgba(0,0,0,0.5)","z-index":"100",width:"100vw",height:"100vh",position:"fixed",left:"0",top:"0",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",gap:"24px"}},_hoisted_2$3={style:{border:"1px white solid",width:"max(80vw, 420px)","background-color":"#111","table-layout":"fixed"}},_hoisted_3$3={style:{height:"80vh",display:"block","overflow-y":"auto"}},_hoisted_4$3={style:{"text-align":"center",width:"60px"}},_hoisted_5$3={style:{"text-align":"center"}},_hoisted_6$3=["onUpdate:modelValue"],_hoisted_7$3={style:{"text-align":"center",width:"60px"}},_hoisted_8$3=["onClick"],_hoisted_9$2=["onClick"],_hoisted_10$2={style:{display:"flex",gap:"24px"}},_sfc_main$b=defineComponent({__name:"FastTextWindow",props:{list:{}},emits:["close","set"],setup(e,{emit:t}){const o=t;return(e,t)=>(openBlock(),createElementBlock("div",_hoisted_1$9,[createBaseVNode("table",_hoisted_2$3,[t[2]||(t[2]=createBaseVNode("thead",null,[createBaseVNode("tr",null,[createBaseVNode("th",{style:{width:"60px"}},"快捷键"),createBaseVNode("th",{style:{width:"auto"}},"文本"),createBaseVNode("th",{style:{width:"60px"}},"操作")])],-1)),createBaseVNode("tbody",_hoisted_3$3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.list,(t,a)=>(openBlock(),createElementBlock("tr",{key:a},[createBaseVNode("td",_hoisted_4$3,[createBaseVNode("p",_hoisted_5$3,"Ctrl + "+toDisplayString(a+1),1)]),createBaseVNode("td",null,[withDirectives(createBaseVNode("textarea",{style:{width:"100%",height:"80px",resize:"vertical","overflow-y":"auto","box-sizing":"border-box"},"onUpdate:modelValue":t=>e.list[a]=t},null,8,_hoisted_6$3),[[vModelText,e.list[a]]])]),createBaseVNode("td",_hoisted_7$3,[createBaseVNode("button",{style:{"background-color":"#d00000",padding:"4px 8px","font-size":"14px"},onClick:t=>e.list.splice(a,1)},"删除",8,_hoisted_8$3),createBaseVNode("button",{style:{"background-color":"#007ffd",padding:"4px 8px","font-size":"14px"},onClick:e=>o("set",t)},"使用",8,_hoisted_9$2)])]))),128))])]),createBaseVNode("div",_hoisted_10$2,[createBaseVNode("button",{style:{"background-color":"#0080ff"},onClick:t[0]||(t[0]=t=>e.list.push(""))},"添加一行"),createBaseVNode("button",{style:{"background-color":"#0080ff"},onClick:t[1]||(t[1]=e=>o("close"))},"完成")])]))}}),FastTextWindow=_export_sfc(_sfc_main$b,[["__scopeId","data-v-508fedf0"]]),_hoisted_1$8={style:{"background-color":"rgba(0,0,0,0.5)","z-index":"100",width:"100vw",height:"100vh",position:"fixed",left:"0",top:"0",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",gap:"24px"}},_hoisted_2$2={style:{border:"1px white solid",width:"max(80vw, 420px)","background-color":"#111","table-layout":"fixed"}},_hoisted_3$2={style:{height:"80vh",display:"block","overflow-y":"auto"}},_hoisted_4$2={style:{"text-align":"center",width:"60px"}},_hoisted_5$2=["onUpdate:modelValue"],_hoisted_6$2={style:{"text-align":"center",width:"60px"}},_hoisted_7$2=["onClick"],_hoisted_8$2={style:{display:"flex",gap:"24px"}},_sfc_main$a=defineComponent({__name:"NotepadWindow",props:{list:{}},emits:["close"],setup(e,{emit:t}){const o=t;return(e,t)=>(openBlock(),createElementBlock("div",_hoisted_1$8,[createBaseVNode("table",_hoisted_2$2,[t[2]||(t[2]=createBaseVNode("thead",null,[createBaseVNode("tr",null,[createBaseVNode("th",{style:{width:"60px"}},"编号"),createBaseVNode("th",{style:{width:"auto"}},"内容"),createBaseVNode("th",{style:{width:"60px"}},"操作")])],-1)),createBaseVNode("tbody",_hoisted_3$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.list.length,t=>(openBlock(),createElementBlock("tr",{key:t,style:{display:"table",width:"100%","table-layout":"fixed"}},[createBaseVNode("td",_hoisted_4$2,[createBaseVNode("p",null,toDisplayString(t),1)]),createBaseVNode("td",null,[withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":o=>e.list[t-1]=o,style:{width:"100%",height:"80px",resize:"vertical","overflow-y":"auto","box-sizing":"border-box"}},null,8,_hoisted_5$2),[[vModelText,e.list[t-1]]])]),createBaseVNode("td",_hoisted_6$2,[createBaseVNode("button",{style:{"background-color":"#d00000",padding:"4px 8px","font-size":"14px"},onClick:o=>e.list.splice(t-1,1)},"删除",8,_hoisted_7$2)])]))),128))])]),createBaseVNode("div",_hoisted_8$2,[createBaseVNode("button",{style:{"background-color":"#0080ff"},onClick:t[0]||(t[0]=t=>e.list.push(""))},"添加记事本"),createBaseVNode("button",{style:{"background-color":"#0080ff"},onClick:t[1]||(t[1]=e=>o("close"))},"完成")])]))}}),NotepadWindow=_export_sfc(_sfc_main$a,[["__scopeId","data-v-acc5477d"]]),_sfc_main$9={},_hoisted_1$7={width:"24",height:"24",viewBox:"0 0 24 24"};function _sfc_render$5(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$7,[...t[0]||(t[0]=[createBaseVNode("path",{d:"M20.952 3.048a3.58 3.58 0 0 0-5.06 0L3.94 15a3.1 3.1 0 0 0-.825 1.476L2.02 21.078a.75.75 0 0 0 .904.903l4.601-1.096a3.1 3.1 0 0 0 1.477-.825l11.95-11.95a3.58 3.58 0 0 0 0-5.06m-4 1.06a2.078 2.078 0 1 1 2.94 2.94L19 7.939L16.06 5zM15 6.062L17.94 9l-10 10c-.21.21-.474.357-.763.426l-3.416.814l.813-3.416c.069-.29.217-.554.427-.764z"},null,-1)])])}const IconEdit=_export_sfc(_sfc_main$9,[["render",_sfc_render$5]]),_sfc_main$8={},_hoisted_1$6={width:"24",height:"24",viewBox:"0 0 24 24"};function _sfc_render$4(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$6,[...t[0]||(t[0]=[createBaseVNode("path",{d:"M12.0223 2.99928C11.7254 3.46286 11.4858 3.96661 11.3133 4.50057L5.25 4.5C4.2835 4.5 3.5 5.2835 3.5 6.25V14.75C3.5 15.7165 4.2835 16.5 5.25 16.5H7.49879L7.49986 20.2506L12.5135 16.5H18.75C19.7165 16.5 20.5 15.7165 20.5 14.75L20.5011 12.2672C21.052 11.98 21.5566 11.616 22.0008 11.1896L22 14.75C22 16.5449 20.5449 18 18.75 18H13.0125L7.99868 21.7507C7.44585 22.1642 6.6625 22.0512 6.24901 21.4984C6.08736 21.2822 6 21.0196 6 20.7499L5.99921 18H5.25C3.45507 18 2 16.5449 2 14.75V6.25C2 4.45507 3.45507 3 5.25 3L12.0223 2.99928ZM17.5 1C20.5376 1 23 3.46243 23 6.5C23 9.53757 20.5376 12 17.5 12C14.4624 12 12 9.53757 12 6.5C12 3.46243 14.4624 1 17.5 1ZM17.5 2.5L17.4101 2.50806C17.206 2.5451 17.0451 2.70603 17.0081 2.91012L17 3L16.999 6H14L13.9101 6.00806C13.706 6.0451 13.5451 6.20603 13.5081 6.41012L13.5 6.5L13.5081 6.58988C13.5451 6.79397 13.706 6.9549 13.9101 6.99194L14 7H16.999L17 10L17.0081 10.0899C17.0451 10.294 17.206 10.4549 17.4101 10.4919L17.5 10.5L17.5899 10.4919C17.794 10.4549 17.9549 10.294 17.9919 10.0899L18 10L17.999 7H21L21.0899 6.99194C21.294 6.9549 21.4549 6.79397 21.4919 6.58988L21.5 6.5L21.4919 6.41012C21.4549 6.20603 21.294 6.0451 21.0899 6.00806L21 6H17.999L18 3L17.9919 2.91012C17.9549 2.70603 17.794 2.5451 17.5899 2.50806L17.5 2.5Z"},null,-1)])])}const IconInsert=_export_sfc(_sfc_main$8,[["render",_sfc_render$4]]),_sfc_main$7={},_hoisted_1$5={width:"24",height:"24",viewBox:"0 0 24 24"};function _sfc_render$3(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$5,[...t[0]||(t[0]=[createBaseVNode("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5ZM15.4462 8.39705L15.5303 8.46967C15.7966 8.73594 15.8208 9.1526 15.6029 9.44621L15.5303 9.53033L13.061 12L15.5303 14.4697C15.7966 14.7359 15.8208 15.1526 15.6029 15.4462L15.5303 15.5303C15.2641 15.7966 14.8474 15.8208 14.5538 15.6029L14.4697 15.5303L12 13.061L9.53033 15.5303C9.26406 15.7966 8.8474 15.8208 8.55379 15.6029L8.46967 15.5303C8.2034 15.2641 8.1792 14.8474 8.39705 14.5538L8.46967 14.4697L10.939 12L8.46967 9.53033C8.2034 9.26406 8.1792 8.8474 8.39705 8.55379L8.46967 8.46967C8.73594 8.2034 9.1526 8.1792 9.44621 8.39705L9.53033 8.46967L12 10.939L14.4697 8.46967C14.7359 8.2034 15.1526 8.1792 15.4462 8.39705Z"},null,-1)])])}const IconRemove=_export_sfc(_sfc_main$7,[["render",_sfc_render$3]]),_sfc_main$6={},_hoisted_1$4={width:"24",height:"24",viewBox:"0 0 24 24"};function _sfc_render$2(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$4,[...t[0]||(t[0]=[createBaseVNode("path",{d:"M12 5C16.6944 5 20.5 8.80558 20.5 13.5C20.5 18.1944 16.6944 22 12 22C7.30558 22 3.5 18.1944 3.5 13.5C3.5 8.80558 7.30558 5 12 5ZM12 6.5C8.13401 6.5 5 9.63401 5 13.5C5 17.366 8.13401 20.5 12 20.5C15.866 20.5 19 17.366 19 13.5C19 9.63401 15.866 6.5 12 6.5ZM12 8C12.3797 8 12.6935 8.28215 12.7432 8.64823L12.75 8.75V13.25C12.75 13.6642 12.4142 14 12 14C11.6203 14 11.3065 13.7178 11.2568 13.3518L11.25 13.25V8.75C11.25 8.33579 11.5858 8 12 8ZM19.1472 5.11371L19.2298 5.17355L20.3882 6.13773C20.7066 6.40272 20.7498 6.87562 20.4849 7.19398C20.2419 7.48581 19.8243 7.54649 19.5112 7.35047L19.4286 7.29063L18.2702 6.32645C17.9518 6.06146 17.9086 5.58856 18.1735 5.2702C18.4165 4.97837 18.8341 4.91769 19.1472 5.11371ZM14.25 2.5C14.6642 2.5 15 2.83579 15 3.25C15 3.6297 14.7178 3.94349 14.3518 3.99315L14.25 4H9.75C9.33579 4 9 3.66421 9 3.25C9 2.8703 9.28215 2.55651 9.64823 2.50685L9.75 2.5H14.25Z"},null,-1)])])}const IconTime=_export_sfc(_sfc_main$6,[["render",_sfc_render$2]]),_sfc_main$5={},_hoisted_1$3={width:"24",height:"24",viewBox:"0 0 24 24"};function _sfc_render$1(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$3,[...t[0]||(t[0]=[createBaseVNode("path",{d:"M2.00008 5.75C2.00008 5.33579 2.33587 5 2.75008 5H21.2501C21.6643 5 22.0001 5.33579 22.0001 5.75C22.0001 6.16421 21.6643 6.5 21.2501 6.5H2.75008C2.33587 6.5 2.00008 6.16421 2.00008 5.75ZM2.00008 12.25C2.00008 11.8358 2.33587 11.5 2.75008 11.5H21.2501C21.6643 11.5 22.0001 11.8358 22.0001 12.25C22.0001 12.6642 21.6643 13 21.2501 13H2.75008C2.33587 13 2.00008 12.6642 2.00008 12.25ZM19.0001 18.75C19.0001 18.3358 19.3359 18 19.7501 18H21.2501C21.6643 18 22.0001 18.3358 22.0001 18.75C22.0001 19.1642 21.6643 19.5 21.2501 19.5H19.7501C19.3359 19.5 19.0001 19.1642 19.0001 18.75ZM2.4161 18.7377C2.62675 18.5972 2.83063 18.4376 3.02344 18.2633V22.25C3.02344 22.6642 3.35922 23 3.77344 23C4.18765 23 4.52344 22.6642 4.52344 22.25V15.75C4.52344 15.356 4.21966 15.033 3.83356 15.0024C3.46481 14.9719 3.12137 15.2183 3.04013 15.5897C2.91354 16.1684 2.34841 16.98 1.58405 17.4896C1.23941 17.7194 1.14628 18.185 1.37604 18.5297C1.60581 18.8743 2.07146 18.9674 2.4161 18.7377ZM8 17.5227C8 16.995 8.44352 16.5 8.98577 16.5C9.39293 16.5 9.7207 16.6909 9.87916 16.9345C10.015 17.1434 10.0966 17.4998 9.78558 18.0292C9.63607 18.2837 9.41005 18.5114 9.10403 18.7531C8.95157 18.8735 8.78845 18.9904 8.61108 19.1158L8.53729 19.1679C8.38506 19.2753 8.2221 19.3902 8.06469 19.5087C7.32108 20.0683 6.5 20.8536 6.5 22.25C6.5 22.6642 6.83579 23 7.25 23L7.25818 23L7.26636 23H10.7006C11.1148 23 11.4506 22.6642 11.4506 22.25C11.4506 21.8358 11.1148 21.5 10.7006 21.5H8.18765C8.34843 21.2182 8.61059 20.9752 8.96663 20.7072C9.1041 20.6038 9.24601 20.5036 9.39926 20.3955L9.47685 20.3407C9.65545 20.2145 9.84717 20.0775 10.0337 19.9302C10.4057 19.6364 10.7945 19.2731 11.0789 18.789C11.6358 17.8411 11.6253 16.868 11.1365 16.1166C10.6704 15.4 9.84098 15 8.98577 15C7.50821 15 6.5 16.2777 6.5 17.5227C6.5 17.9369 6.83579 18.2727 7.25 18.2727C7.66421 18.2727 8 17.9369 8 17.5227ZM14.4711 17.1377C14.5032 17.0255 14.5795 16.8666 14.722 16.7409C14.8504 16.6276 15.0775 16.5 15.5 16.5C16.2612 16.5 16.5 17.0002 16.5 17.2273C16.5 17.4724 16.4476 17.7178 16.3102 17.8907C16.1989 18.0308 15.9315 18.25 15.2083 18.25C14.7941 18.25 14.4583 18.5858 14.4583 19C14.4583 19.4142 14.7941 19.75 15.2083 19.75C15.4818 19.75 15.8597 19.7864 16.1427 19.9191C16.2745 19.9809 16.3571 20.0505 16.4071 20.1207C16.4519 20.1837 16.5 20.287 16.5 20.4773C16.5 20.965 16.3477 21.1807 16.2193 21.2891C16.0682 21.4167 15.8239 21.5 15.5 21.5C15.138 21.5 14.9331 21.4374 14.8074 21.3578C14.6961 21.2873 14.5677 21.1538 14.4624 20.8338C14.3329 20.4403 13.909 20.2263 13.5155 20.3558C13.1221 20.4852 12.9081 20.9092 13.0375 21.3026C13.2239 21.8689 13.533 22.3263 14.005 22.6252C14.4627 22.9149 14.9869 23 15.5 23C16.051 23 16.6817 22.8618 17.1869 22.4353C17.7147 21.9898 18 21.3191 18 20.4773C18 20.0027 17.8701 19.5891 17.6288 19.2504C17.5501 19.14 17.4631 19.0423 17.3708 18.9559C17.4104 18.9135 17.4483 18.8695 17.4844 18.8241C17.9223 18.2731 18 17.6321 18 17.2273C18 16.1543 17.072 15 15.5 15C14.7345 15 14.1485 15.2466 13.7298 15.616C13.3252 15.9728 13.1205 16.4048 13.0288 16.7259C12.9151 17.1242 13.1457 17.5393 13.544 17.653C13.9423 17.7667 14.3574 17.536 14.4711 17.1377Z"},null,-1)])])}const IconToken=_export_sfc(_sfc_main$5,[["render",_sfc_render$1]]),_sfc_main$4={},_hoisted_1$2={width:"24",height:"24",viewBox:"0 0 24 24"};function _sfc_render(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$2,[...t[0]||(t[0]=[createBaseVNode("path",{d:"m7.47 12.28l.084.073a.75.75 0 0 0 .977-.073l2.72-2.72v6.69l.007.102A.75.75 0 0 0 12 17l.101-.006a.75.75 0 0 0 .649-.744V9.56l2.72 2.722l.084.072a.75.75 0 0 0 .977-1.133l-4-4.001l-.084-.073a.75.75 0 0 0-.977.073l-4 4l-.073.085a.75.75 0 0 0 .072.976M22.001 12c0-5.523-4.477-10-10-10s-10 4.477-10 10s4.477 10 10 10s10-4.477 10-10m-18.5 0a8.5 8.5 0 1 1 17 0a8.5 8.5 0 0 1-17 0"},null,-1)])])}const IconUp=_export_sfc(_sfc_main$4,[["render",_sfc_render]]),_sfc_main$3=defineComponent({__name:"IconDown",setup:e=>(e,t)=>(openBlock(),createBlock(IconUp,{style:{transform:"rotate(180deg)"}}))}),_hoisted_1$1={style:{"background-color":"rgba(0,0,0,0.5)","z-index":"100",width:"100vw",height:"100vh",position:"fixed",left:"0",top:"0",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",gap:"24px"}},_hoisted_2$1={style:{height:"80vh",width:"80vw",display:"flex",background:"#222"}},_hoisted_3$1={style:{width:"220px",background:"#222","border-right":"1px solid #333",display:"flex","flex-direction":"column",gap:"8px"}},_hoisted_4$1=["onClick"],_hoisted_5$1=["onClick"],_hoisted_6$1={style:{flex:"1",padding:"24px","overflow-y":"auto"}},_hoisted_7$1={key:0},_hoisted_8$1={style:{color:"#aaa","margin-bottom":"8px"}},_hoisted_9$1={style:{color:"#aaa","margin-bottom":"8px",display:"flex"}},_hoisted_10$1={style:{color:"#aaa","margin-bottom":"8px"}},_hoisted_11$1={style:{"margin-top":"8px",background:"#1f1f1f",border:"1px solid #333","border-radius":"6px",padding:"12px"}},_hoisted_12$1={key:0,style:{color:"#888"}},_hoisted_13$1={key:1},_hoisted_14$1={style:{width:"100%","border-collapse":"collapse"}},_hoisted_15$1={style:{padding:"6px 4px"}},_hoisted_16$1=["value","onChange"],_hoisted_17$1={style:{padding:"6px 4px"}},_hoisted_18$1=["value","onChange"],_hoisted_19$1=["value"],_hoisted_20$1=["value"],_hoisted_21$1=["value"],_hoisted_22$1=["value"],_hoisted_23$1=["value"],_hoisted_24$1={style:{padding:"6px 4px"}},_hoisted_25$1=["onUpdate:modelValue"],_hoisted_26$1={style:{padding:"6px 4px"}},_hoisted_27$1=["value","onInput"],_hoisted_28$1={style:{padding:"6px 4px","text-align":"right"}},_hoisted_29$1=["onClick"],_hoisted_30$1={style:{"margin-top":"12px"}},_hoisted_31$1={style:{"margin-top":"6px",display:"flex",gap:"12px","flex-wrap":"wrap"}},_hoisted_32$1=["checked","onChange"],_hoisted_33$1={style:{color:"#aaa"}},_hoisted_34$1={key:1,style:{color:"#888"}},_sfc_main$2=defineComponent({__name:"FunctionDeclarationWindow",emits:["close"],setup(e,{emit:t}){const o=generationConfig.functionDeclarations,a=ref(0),n=ref(),i=t,l=ref("");function s(){if(n.value)try{n.value.function=new Function("args",l.value),n.value.code=l.value}catch(e){n.value.function=void 0}i("close")}function r(e){a.value=e,n.value=o[e],l.value=n.value.code??""}function d(){let e="new_function",t=e,a=1;for(;o.some(e=>e.name===t);)t=`${e}_${a++}`;r(o.push({name:t,description:"请填写函数描述。",parameters:{type:FunctionType.OBJECT,properties:{},required:[]}})-1)}function c(){const e=n.value.parameters.properties,t=function(e){const t=n.value.parameters.properties;let o=e,a=1;for(;Object.prototype.hasOwnProperty.call(t,o);)o=`${e}_${a++}`;return o}("param");e[t]={type:FunctionType.STRING,description:""}}return o.length&&r(0),(e,t)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",_hoisted_3$1,[createBaseVNode("button",{onClick:d,style:{margin:"12px 8px 0 8px",padding:"6px 0",border:"none","border-radius":"6px",background:"#444",color:"#fff","font-size":"15px"}},"➕ 新增函数"),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(o),(e,t)=>(openBlock(),createElementBlock("div",{key:e.name,style:normalizeStyle({background:a.value===t?"#333":"transparent",color:a.value===t?"#fff":"#ccc",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"}),onClick:e=>r(t)},[createBaseVNode("span",null,toDisplayString(e.name),1),unref(o).length>1?(openBlock(),createElementBlock("span",{key:0,onClick:withModifiers(e=>function(e){1!==o.length&&(o.splice(e,1),a.value>=o.length&&(a.value=o.length-1))}(t),["stop"]),style:{color:"#ff4d4f","margin-left":"8px","font-size":"16px",cursor:"pointer"},title:"删除"},"🗑️",8,_hoisted_5$1)):createCommentVNode("",!0)],12,_hoisted_4$1))),128))]),createBaseVNode("div",_hoisted_6$1,[unref(o)[a.value]?(openBlock(),createElementBlock("div",_hoisted_7$1,[createBaseVNode("div",_hoisted_8$1,[t[3]||(t[3]=createBaseVNode("b",{style:{"min-width":"32px"}},"名称",-1)),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>unref(o)[a.value].name=e),type:"text",style:{"margin-left":"8px",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px",padding:"8px"}},null,512),[[vModelText,unref(o)[a.value].name]])]),createBaseVNode("div",_hoisted_9$1,[t[4]||(t[4]=createBaseVNode("b",{style:{"min-width":"32px"}},"描述",-1)),withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>unref(o)[a.value].description=e),style:{"margin-left":"8px",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px",width:"auto",height:"auto",resize:"horizontal"}},null,512),[[vModelText,unref(o)[a.value].description]])]),createBaseVNode("div",_hoisted_10$1,[t[8]||(t[8]=createBaseVNode("b",null,"参数",-1)),createBaseVNode("div",_hoisted_11$1,[createBaseVNode("div",{style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"8px"}},[t[5]||(t[5]=createBaseVNode("b",{style:{color:"#ddd"}},"properties（参数列表）",-1)),createBaseVNode("button",{onClick:c,style:{padding:"4px 8px",border:"none","border-radius":"4px",background:"#444",color:"#fff"}},"➕ 新增参数")]),0===Object.keys(n.value.parameters.properties).length?(openBlock(),createElementBlock("div",_hoisted_12$1,"暂无参数")):(openBlock(),createElementBlock("div",_hoisted_13$1,[createBaseVNode("table",_hoisted_14$1,[t[6]||(t[6]=createBaseVNode("thead",null,[createBaseVNode("tr",null,[createBaseVNode("th",{style:{"text-align":"left",color:"#999","font-weight":"normal",padding:"6px 4px"}},"键名"),createBaseVNode("th",{style:{"text-align":"left",color:"#999","font-weight":"normal",padding:"6px 4px"}},"类型"),createBaseVNode("th",{style:{"text-align":"left",color:"#999","font-weight":"normal",padding:"6px 4px"}},"描述"),createBaseVNode("th",{style:{"text-align":"left",color:"#999","font-weight":"normal",padding:"6px 4px"}},"枚举（逗号）"),createBaseVNode("th",{style:{width:"64px"}})])],-1)),createBaseVNode("tbody",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(n.value.parameters.properties,(e,t)=>(openBlock(),createElementBlock("tr",{key:t},[createBaseVNode("td",_hoisted_15$1,[createBaseVNode("input",{value:t,onChange:e=>function(e,t){const o=(t||"").trim();if(!o||o===e)return;if(!/^[A-Za-z_][A-Za-z0-9_]*$/.test(o))return;const a=n.value.parameters,i=a.properties;i[o]=i[e],delete i[e],a.required=a.required.map(t=>t===e?o:t)}(String(t),e.target.value),type:"text",style:{width:"100%",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px",padding:"4px 8px"}},null,40,_hoisted_16$1)]),createBaseVNode("td",_hoisted_17$1,[createBaseVNode("select",{value:e.type,onChange:e=>function(e,t){const o=t,a=n.value.parameters.properties;a[e].type=o,o!==FunctionType.STRING&&a[e].enum&&delete a[e].enum}(String(t),e.target.value),style:{width:"100%",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px"}},[createBaseVNode("option",{value:unref(FunctionType).STRING},"string",8,_hoisted_19$1),createBaseVNode("option",{value:unref(FunctionType).NUMBER},"number",8,_hoisted_20$1),createBaseVNode("option",{value:unref(FunctionType).BOOLEAN},"boolean",8,_hoisted_21$1),createBaseVNode("option",{value:unref(FunctionType).OBJECT},"object",8,_hoisted_22$1),createBaseVNode("option",{value:unref(FunctionType).ARRAY},"array",8,_hoisted_23$1)],40,_hoisted_18$1)]),createBaseVNode("td",_hoisted_24$1,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t=>e.description=t,type:"text",placeholder:"参数用途、格式与限制",style:{width:"100%",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px",padding:"4px 8px"}},null,8,_hoisted_25$1),[[vModelText,e.description]])]),createBaseVNode("td",_hoisted_26$1,[e.type===unref(FunctionType).STRING?(openBlock(),createElementBlock("input",{key:0,value:(e.enum||[]).join(", "),onInput:e=>function(e,t){const o=t.split(",").map(e=>e.trim()).filter(e=>e.length>0),a=n.value.parameters.properties;a[e]&&(0===o.length?delete a[e].enum:a[e].enum=o)}(String(t),e.target.value),type:"text",placeholder:"例如:warm, cool, daylight",style:{width:"100%",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px",padding:"4px 8px"}},null,40,_hoisted_27$1)):createCommentVNode("",!0)]),createBaseVNode("td",_hoisted_28$1,[createBaseVNode("button",{onClick:e=>function(e){const t=n.value.parameters;delete t.properties[e],t.required=t.required.filter(t=>t!==e)}(String(t)),style:{padding:"4px 8px",border:"none","border-radius":"4px",background:"#553",color:"#ffb3b3"}},"删除 ",8,_hoisted_29$1)])]))),128))])])])),createBaseVNode("div",_hoisted_30$1,[t[7]||(t[7]=createBaseVNode("b",{style:{color:"#ddd"}},"required（必填参数）",-1)),createBaseVNode("div",_hoisted_31$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(Object.keys(n.value.parameters.properties),e=>(openBlock(),createElementBlock("label",{key:e,style:{display:"inline-flex","align-items":"center",gap:"6px",color:"#ccc",background:"#262626",border:"1px solid #333","border-radius":"16px",padding:"4px 10px"}},[createBaseVNode("input",{checked:n.value.parameters.required.includes(e),type:"checkbox",onChange:t=>function(e,t){const o=n.value.parameters,a=o.required;t?a.includes(e)||a.push(e):o.required=a.filter(t=>t!==e)}(e,t.target.checked)},null,40,_hoisted_32$1),createBaseVNode("span",null,toDisplayString(e),1)]))),128))])])])]),createBaseVNode("div",_hoisted_33$1,[t[9]||(t[9]=createBaseVNode("b",null,"函数",-1)),withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.value=e),style:{"margin-top":"8px",background:"#333",color:"#fff",border:"1px solid #444","border-radius":"4px",padding:"8px",width:"100%",height:"200px",resize:"vertical","font-family":"monospace"}},null,512),[[vModelText,l.value]])])])):(openBlock(),createElementBlock("div",_hoisted_34$1,"未选择函数"))])]),createBaseVNode("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"none","border-radius":"8px",cursor:"pointer","font-size":"16px"}},"关闭")]))}}),FunctionDeclarationWindow=_export_sfc(_sfc_main$2,[["__scopeId","data-v-65110904"]]),_sfc_main$1=defineComponent({__name:"FunctionCallPart",props:{part:{},isEdit:{}},setup(e){const t=!!e.part.functionCall;watch(()=>e.isEdit,a=>{a?o.value=t?JSON.stringify(e.part.functionCall):JSON.stringify(e.part.functionResponse):t?e.part.functionCall=JSON.parse(o.value):e.part.functionResponse=JSON.parse(o.value)});const o=ref("");return(e,a)=>t?(openBlock(),createElementBlock(Fragment,{key:0},[e.isEdit?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),style:{width:"100%"}},null,512)),[[vModelText,o.value]]):(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("p",null,toDisplayString(e.part.functionCall.name),1),createBaseVNode("p",null,toDisplayString(e.part.functionCall.args??"无参数"),1)],64))],64)):(openBlock(),createElementBlock(Fragment,{key:1},[e.isEdit?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),style:{width:"100%"}},null,512)),[[vModelText,o.value]]):(openBlock(),createElementBlock(Fragment,{key:1},[createBaseVNode("p",null,toDisplayString(e.part.functionResponse.name),1),createBaseVNode("p",null,toDisplayString(e.part.functionResponse.response??"未定义"),1)],64))],64))}}),_hoisted_1={id:"chat"},_hoisted_2={style:{width:"100%"}},_hoisted_3={style:{display:"flex","justify-content":"space-between","align-items":"center",height:"40px"}},_hoisted_4={style:{display:"flex","align-items":"center"}},_hoisted_5={style:{"pointer-events":"none",color:"#00ffe6","margin-left":"8px"}},_hoisted_6={style:{display:"flex","align-items":"center",gap:"8px"}},_hoisted_7={class:"tool-button"},_hoisted_8=["onClick","onContextmenu"],_hoisted_9={class:"tag"},_hoisted_10={style:{display:"flex","align-items":"center",gap:"4px"}},_hoisted_11=["onClick"],_hoisted_12={key:0},_hoisted_13={key:1},_hoisted_14={key:1,width:"24",height:"24",viewBox:"0 0 24 24"},_hoisted_15=["onClick"],_hoisted_16=["onClick"],_hoisted_17=["onClick"],_hoisted_18=["onClick"],_hoisted_19=["onClick"],_hoisted_20={key:0,class:"tool",style:{"margin-top":"8px"}},_hoisted_21=["onUpdate:modelValue","onKeydown"],_hoisted_22={key:3,class:"tool"},_hoisted_23={style:{width:"100%",display:"flex"}},_hoisted_24={style:{padding:"8px","font-size":"14px"}},_hoisted_25={style:{"border-radius":"4px",border:"1px solid #36a2c3",padding:"0 4px",margin:"0 4px"}},_hoisted_26={style:{padding:"8px",display:"flex","flex-wrap":"wrap",gap:"4px"}},_hoisted_27={style:{"border-radius":"4px",border:"1px solid #36a2c3",padding:"0 4px","font-size":"14px"}},_hoisted_28={id:"input-container"},_hoisted_29={key:0,class:"history",style:{position:"fixed",width:"100vw",transform:"translateY(-100%)"}},_hoisted_30={style:{display:"flex",gap:"16px"}},_hoisted_31={style:{display:"flex","align-items":"center"}},_hoisted_32={key:0},_hoisted_33={key:0},_hoisted_34={key:1,style:{"min-width":"80px"}},_hoisted_35={style:{width:"calc(100% - 90px)"}},_hoisted_36={class:"text"},_hoisted_37={style:{width:"100%",height:"100%","overflow-y":"scroll","overflow-x":"hidden",display:"flex","flex-direction":"column",gap:"16px",padding:"16px"}},_hoisted_38={class:"function"},_hoisted_39={class:"setting",style:{display:"flex",gap:"8px"}},_hoisted_40={class:"setting"},_hoisted_41={class:"text",style:{gap:"8px"}},_hoisted_42=["value"],_hoisted_43={style:{display:"flex",gap:"8px","justify-content":"space-between",margin:"4px 0"}},_hoisted_44={style:{color:"#aaa"}},_hoisted_45={style:{display:"flex"}},_hoisted_46={style:{flex:"1","padding-left":"8px",display:"flex","justify-content":"space-between"}},_hoisted_47={style:{color:"#aaa"}},_hoisted_48={class:"setting"},_hoisted_49={style:{display:"flex",gap:"8px","justify-content":"space-between"}},_hoisted_50={class:"setting",style:{gap:"8px"}},_hoisted_51={class:"text"},_hoisted_52={style:{"font-size":"20px"}},_hoisted_53={style:{color:"#aaa"}},_hoisted_54=["max"],_hoisted_55={class:"text"},_hoisted_56={style:{"font-size":"20px"}},_hoisted_57={style:{display:"flex",gap:"8px","margin-top":"8px"}},_hoisted_58={class:"setting",style:{gap:"8px"}},_hoisted_59={style:{display:"flex",gap:"8px","justify-content":"space-between"}},_sfc_main=defineComponent({__name:"Chat",props:{data:{},mode:{},toolSave:{type:Function},toolRename:{type:Function},toolRemove:{type:Boolean,default:!1}},setup(__props){let contentId=0;const contents=reactive([]);function markdownSanitize(e){const t=["script","script setup","style","template","title","button","style","a","p"];for(let o of t)e=e.replace("<"+o+">","<"+o+">");return e}const dialogNameRef=ref(),showDialogInput=ref(!1),dialogName=ref(Router.param()||"新对话");document.title=dialogName.value;const systemRef=ref(),showSystemPrompt=ref(!1),hideSystem=ref(!1);function changeShowDialogInput(){showDialogInput.value=!0,dialogNameRef.value.focus()}function changeShowSystem(){showSystemPrompt.value=!showSystemPrompt.value}function newDialog(e){clear(e)&&(dialogName.value="新对话",systemInstruction.value="使用中文回复用户",Router.push("local/default"),filterList.length=0)}function rename(){dialogName.value.includes("/")?Utils.showTip("错误","名字不可以包含斜杠"):(showDialogInput.value=!1,__props.toolRename(dialogName.value),document.title=dialogName.value)}function clear(e){return!(e&&!confirm("确认要清空对话历史记录")||(contents.length=0,tokenCount.value="0",0))}function deleteDialog(){if(confirm("确认要删除对话")){const e=dialogName.value;Database.remove("gemini_db",e),newDialog(!1),Utils.showTip("文件","对话已删除")}}function load(){systemInstruction.value="使用中文回复用户";const{contents:e,generationConfig:t,filter:o,fastText:a,notepad:n,autoFoldThreshold:i}=__props.data;if(o&&filterList.push(...o),a&&fastTextList.push(...a),n&&notepadList.push(...n),generationConfig.functionDeclarations.length=0,t&&Object.assign(generationConfig,t),generationConfig.thinkingConfig.includeThoughts=!0,i&&(autoFoldThreshold.value=i),!e)return;contents.length=0;const{systemInstruction:l,selectModel:s}=__props.data;for(const r of e)r.id=++contentId,contents.push(r);systemInstruction.value=l,Gemini.useModel(s);for(const r of generationConfig.functionDeclarations)r.code&&(r.function=new Function("args",r.code));Utils.showTip("文件","读取成功"),countToken(),requestAnimationFrame(scrollToBottom)}function buildDialogData(e=!1){return{contents:(e?getFiltedContents(contents):contents).map(({role:e,parts:t,hide:o})=>({role:e,parts:t,hide:o})),systemInstruction:systemInstruction.value,selectModel:{name:selectModel.value?.name,studio:selectModel.value?.studio},generationConfig:generationConfig,filter:filterList,fastText:fastTextList,notepad:notepadList,autoFoldThreshold:autoFoldThreshold.value,functionDeclarations:generationConfig.functionDeclarations.map(e=>({...e,function:void 0}))}}async function save(){__props.toolSave(buildDialogData())}onMounted(()=>{load(),systemRef.value=document.getElementById("system").getElementsByClassName("md-editor")[0],window.onkeydown=function(e){if(e.ctrlKey){switch(e.key){case"s":save();break;case"q":insertThinkingPrompt(contents.length);break;case"/":clear(!0);break;case"ArrowDown":enableScrollToBottom();break;case"ArrowUp":scrollToTop();break;default:const t=parseInt(e.key);if(!(t>=1&&t<=9))return;{const e=fastTextList[t-1];e&&(inputPrompt.value=e)}}e.preventDefault()}}});const showSidebar=ref(!1),tokenCount=ref("0"),autoFoldThreshold=ref(1/0),selectModel=Gemini.selectModel;function importHistory(){const data=eval("("+prompt("导入数据","[]")+")");systemInstruction.value=data.systemInstruction.constructor===String?data.systemInstruction:data.systemInstruction.parts[0].text;for(let e of data.contents){const t=e.role;for(let o of e.parts)contents.push({role:t,parts:[{text:o.text}],id:++contentId})}showSidebar.value=showSystemPrompt.value=!systemInstruction.value}function exportHistory(){copyToClipboard(JSON.stringify(buildDialogData(confirm("是否要过滤？"))))}async function upgradeToOnline(){Utils.showTip("对话","正在升级为在线对话"),await CloudFlare.uploadOnlineDialog("online",dialogName.value,JSON.stringify(buildDialogData())),Router.push("online/"+dialogName.value)}function countToken(){tokenCount.value="计算中";const e=[{parts:[{text:systemInstruction.value}],role:"system"}];e.push(...buildDialogData(!0).contents.map(e=>({parts:e.parts,role:e.role}))),fetch(`https://generativelanguage.googleapis.com/v1beta/models/${Gemini.selectModel.value.name}:countTokens?key=${Gemini.key.value}`,{method:"POST",headers:Gemini.headers,body:JSON.stringify({contents:e})}).then(e=>e.json()).then(e=>tokenCount.value=e.totalTokens)}const autoScrollToBottom=ref(!0);let firstSelectIndex=-1;function selectFirst(e){if(-1!==firstSelectIndex){let t=Math.min(firstSelectIndex,e),o=Math.max(firstSelectIndex,e);return void(confirm(`你要批量删除 [${t}, ${o}] 的对话记录吗？`)?(contents.splice(t,o-t+1),Utils.showTip("批量删除",`已批量删除 [${t}. ${o}] 的对话记录`),firstSelectIndex=-1):confirm("取消选中？")&&(Utils.showTip("批量选中","已取消选中"),firstSelectIndex=-1))}firstSelectIndex=e,Utils.showTip("批量选中",`已选择 ${e}，再次使用【Shift+左键】即可批量选中`)}function scrollToTop(){window.scrollTo(0,0),autoScrollToBottom.value=!1}function scrollToBottom(){window.scrollTo(0,document.body.scrollHeight)}function enableScrollToBottom(){scrollToBottom(),autoScrollToBottom.value=!0}function getFiltedContents(e){const t=[];for(const o of e){const e=JSON.parse(JSON.stringify(o.parts)),a={role:o.role,parts:e};let n=e[0].text;if(n){for(let e=filterList.length-1;e>=0;e--)n=n.replaceAll(filterList[e][0],filterList[e][1]);e[0].text=n}t.push(a)}return t}const inputPrompt=ref(""),generatingTempData=ref(),generatingDialog=ref(null);let selectSection=!1;function pushMessage(){let e=inputPrompt.value;e.endsWith("\n")&&(e=e.slice(0,-1)),inputPrompt.value="",contents.push({role:"user",parts:[{text:e}],id:++contentId}),requestAnimationFrame(scrollToBottom)}function sendMessage(){generatingTempData.value?generatingTempData.value.stop():(inputPrompt.value&&pushMessage(),generateMessage(reactive({role:"model",parts:[],id:++contentId}),contents.length))}document.onmousedown=()=>selectSection=!0,document.onmouseup=()=>requestAnimationFrame(()=>selectSection=0!==window.getSelection().toString().length);const enableGenerateAnimation=ref(!0);async function generateMessage(e,t){if(generatingTempData.value)return void generatingTempData.value.stop();let o=0;t===contents.length-1&&(autoScrollToBottom.value=!0),e.generating=1;const a=Date.now();generatingDialog.value=contents[t]=e,e.networkTime="",o=setInterval(function(){e.networkTime=((Date.now()-a)/1e3).toFixed(1)},100);let n=setInterval(function(){if(!selectSection){for(let e=0;s<l&&e!==r;++e)d.text+=i[s],++s;autoScrollToBottom.value&&scrollToBottom()}},16),i="",l=0,s=0,r=0,d=reactive({text:""});e.parts.push(d);let c=!1;const p=[];function u(){if(c)return;c=!0,delete e.thought,delete e.generating,generatingDialog.value=null,generatingTempData.value=null,clearInterval(o),clearInterval(n);for(let e=filterList.length-1;e>=0;e--)i=i.replaceAll(filterList[e][1],filterList[e][0]);d.text=i,autoScrollToBottom.value&&requestAnimationFrame(scrollToBottom);let t=p.length;if(t){const o=contents.indexOf(e);contents.splice(o+1,0,{role:"model",parts:p,id:++contentId});const a=[];for(const e of p){const{name:o,args:n}=e.functionCall,i=generationConfig.functionDeclarations.find(e=>e.name===o);let l={result:""};i.function&&(--t,l=i.function(n)),a.push({functionResponse:{name:o,response:l}})}contents.splice(o+2,0,{role:"user",parts:a,id:++contentId}),0===t&&requestAnimationFrame(sendMessage)}}generatingTempData.value={token:0,stop:await Gemini.streamGenerateContent(getFiltedContents(contents.slice(0,t)),function(){const t=Date.now();e.networkTime=((t-a)/1e3).toFixed(1),clearInterval(o),o=setInterval(function(){e.generatingTime=((Date.now()-t)/1e3).toFixed(1)},100)},function(t){const{candidates:o}=t;if(o){const a=o[0],{content:n,finishReason:d}=a;if(n){const o=n.parts;if(o)for(const t of o)t.text?t.thought?e.thought=(e.thought??"")+t.text:(i+=t.text,l=i.length):t.functionCall&&p.push({thoughtSignature:t.thoughtSignature,functionCall:t.functionCall});r=enableGenerateAnimation.value?Math.max(1,Math.floor((l-s)/60)):1e3;const{totalTokenCount:a=0,thoughtsTokenCount:d=0,candidatesTokenCount:c=0}=t.usageMetadata;tokenCount.value=a,generatingTempData.value.token=d?`${d}+${c}=${d+c}`:c}if(d){e.finishReason=d;const{groundingMetadata:t}=a;return t&&t.searchEntryPoint&&(delete t.searchEntryPoint,e.search=t),void u()}}else if(t.promptFeedback)return e.finishReason=t.promptFeedback.blockReason,void u();autoScrollToBottom.value&&requestAnimationFrame(scrollToBottom)},function(e){Utils.showTip("生成错误",e+"")},u)}}function switchRole(e){e.role="model"===e.role?"user":"model"}function retry(e){generateMessage(reactive({role:"model",parts:[],id:++contentId}),e)}function remove(e){contents.splice(e,1)}function insert(e){contents.splice(e,0,reactive({role:"user",parts:[reactive({text:""})],edit:!0,id:++contentId}))}function insertThinkingPrompt(e){contents.splice(e+1,0,reactive({role:"model",parts:[reactive({text:"Here's a breakdown of my thought process"})],id:++contentId}))}function up(e){if(e>0){const t=contents[e-1];contents[e-1]=contents[e],contents[e]=t}}function down(e){if(e<contents.length-1){const t=contents[e+1];contents[e+1]=contents[e],contents[e]=t}}function copyToClipboard(e){navigator.clipboard.writeText(e),Utils.showTip("对话","复制成功")}function ctrlEnterEditCompelete(e,t){e.edit=!e.edit;const o=e.parts[0],a=o.text;if(o.text=a.substring(0,a.length-1),"user"===e.role){for(;contents[++t]&&"user"===contents[t].role;);retry(t)}}function handleDoubleClick(e){e.preventDefault();const t=e.target,o=t.getBoundingClientRect();e.clientX>=o.right-20&&e.clientY>=o.bottom-20&&(t.style.height=Math.min(400,t.scrollHeight)+"px")}const rightClickMenu=reactive({show(e,t){this.content=t,this.index=contents.indexOf(t),this.visible=!0,this.left=e.clientX+177>window.innerWidth?window.innerWidth-177+"px":e.clientX+"px",e.clientY+490>window.innerHeight?(this.top="",this.bottom="0px"):(this.top=e.clientY+"px",this.bottom="")},appendToPrevious(){let e=contents.indexOf(this.content);const t=this.content.role;for(;--e>-1&&contents[e].role!==t;);const o=contents[e].parts[0],a=this.content.parts[0];o.text+=a.text,a.text=""},switchFilter(){const e=this.content.parts[0];let t=e.text;for(let o=filterList.length-1;o>=0;o--)t=this.filter?t.replaceAll(filterList[o][0],filterList[o][1]):t.replaceAll(filterList[o][1],filterList[o][0]);e.text=t,this.filter=!this.filter},filter:!1,visible:!1,index:0,content:contents[0],left:"0",top:"0",bottom:"0"});function gotoHome(){"docker"===studioStatus?Utils.confirm(()=>Router.push("home")):confirm("你确定回到主页吗")&&Router.push("home")}const filterList=reactive([]),filterWindowShow=ref(!1),fastTextList=reactive([]),fastTextWindowShow=ref(!1),notepadList=reactive([]),notepadWindowShow=ref(!1),functionDeclarationWindowShow=ref(!1),isPhone=window.innerWidth<600;return window.onwheel=window.ontouchstart=function(){autoScrollToBottom.value=!1},(e,t)=>(openBlock(),createElementBlock(Fragment,null,[fastTextWindowShow.value?(openBlock(),createBlock(FastTextWindow,{key:0,list:fastTextList,onClose:t[0]||(t[0]=e=>fastTextWindowShow.value=!1),onSet:t[1]||(t[1]=e=>inputPrompt.value=e)},null,8,["list"])):createCommentVNode("",!0),filterWindowShow.value?(openBlock(),createBlock(FilterWindow,{key:1,list:filterList,onClose:t[2]||(t[2]=e=>filterWindowShow.value=!1)},null,8,["list"])):createCommentVNode("",!0),notepadWindowShow.value?(openBlock(),createBlock(NotepadWindow,{key:2,list:notepadList,onClose:t[3]||(t[3]=e=>notepadWindowShow.value=!1)},null,8,["list"])):createCommentVNode("",!0),functionDeclarationWindowShow.value?(openBlock(),createBlock(FunctionDeclarationWindow,{key:3,onClose:t[4]||(t[4]=e=>functionDeclarationWindowShow.value=!1)})):createCommentVNode("",!0),createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[withDirectives(createBaseVNode("aside",{id:"system",style:normalizeStyle({animationPlayState:generatingTempData.value?"running":"paused",height:showSystemPrompt.value?"100vh":"40px"}),onClick:t[8]||(t[8]=e=>showSystemPrompt.value=!1)},[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("button",{onClick:gotoHome},[...t[44]||(t[44]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z"})],-1)])]),isPhone?createCommentVNode("",!0):(openBlock(),createElementBlock("button",{key:0,style:{"font-size":"18px"},onClick:withModifiers(changeShowSystem,["stop"])},"提示词")),createBaseVNode("p",_hoisted_5,toDisplayString(e.mode),1)]),createBaseVNode("div",_hoisted_6,[withDirectives(createBaseVNode("input",{style:{height:"32px",display:"block"},"onUpdate:modelValue":t[5]||(t[5]=e=>dialogName.value=e),onKeydown:withKeys(rename,["enter"]),onBlur:rename,ref_key:"dialogNameRef",ref:dialogNameRef},null,544),[[vModelText,dialogName.value],[vShow,showDialogInput.value]])]),createBaseVNode("div",_hoisted_7,[e.toolRename?(openBlock(),createElementBlock("button",{key:0,onClick:changeShowDialogInput},[...t[45]||(t[45]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M9.75 2h3.998a.75.75 0 0 1 .102 1.493l-.102.007H12.5v17h1.245a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.648.743l-.102.007H9.75a.75.75 0 0 1-.102-1.493l.102-.007H11v-17H9.75a.75.75 0 0 1-.743-.648L9 2.75a.75.75 0 0 1 .648-.743zh3.998zm8.496 2.997a3.253 3.253 0 0 1 3.25 3.25l.004 7.504a3.25 3.25 0 0 1-3.064 3.246l-.186.005h-4.745v-1.5h4.803A1.75 1.75 0 0 0 20 15.751l-.003-7.505a1.753 1.753 0 0 0-1.752-1.75h-4.74v-1.5zm-8.246 0v1.5H5.25a1.75 1.75 0 0 0-1.75 1.75v7.504c0 .967.784 1.75 1.75 1.75h4.745v1.5H5.25A3.25 3.25 0 0 1 2 15.751V8.247a3.25 3.25 0 0 1 3.25-3.25z"})],-1)])])):createCommentVNode("",!0),e.toolRemove?(openBlock(),createElementBlock("button",{key:1,onClick:deleteDialog},[...t[46]||(t[46]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M14 5a2 2 0 1 0-4 0zM8.5 5a3.5 3.5 0 1 1 7 0h5.75a.75.75 0 0 1 0 1.5h-1.32l-.502 5.195a6.5 6.5 0 0 0-1.456-.528l.452-4.667H5.576l1.158 11.967a2.25 2.25 0 0 0 2.24 2.033h1.758A6.5 6.5 0 0 0 11.81 22H8.974a3.75 3.75 0 0 1-3.733-3.389L4.07 6.5H2.75a.75.75 0 0 1 0-1.5zM22 17.5a5.5 5.5 0 1 1-11 0a5.5 5.5 0 0 1 11 0m-7.146-2.354a.5.5 0 0 0-.708.708l1.647 1.646l-1.647 1.646a.5.5 0 0 0 .708.708l1.646-1.647l1.646 1.647a.5.5 0 0 0 .708-.708L17.207 17.5l1.647-1.646a.5.5 0 0 0-.708-.708L16.5 16.793z"})],-1)])])):createCommentVNode("",!0),createBaseVNode("button",{onClick:save},[...t[47]||(t[47]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M3 5.75A2.75 2.75 0 0 1 5.75 3h9.965a3.25 3.25 0 0 1 2.298.952l2.035 2.035c.61.61.952 1.437.952 2.299v9.964A2.75 2.75 0 0 1 18.25 21H5.75A2.75 2.75 0 0 1 3 18.25zM5.75 4.5c-.69 0-1.25.56-1.25 1.25v12.5c0 .69.56 1.25 1.25 1.25H6v-5.25A2.25 2.25 0 0 1 8.25 12h7.5A2.25 2.25 0 0 1 18 14.25v5.25h.25c.69 0 1.25-.56 1.25-1.25V8.286c0-.465-.184-.91-.513-1.238l-2.035-2.035a1.75 1.75 0 0 0-.952-.49V7.25a2.25 2.25 0 0 1-2.25 2.25h-4.5A2.25 2.25 0 0 1 7 7.25V4.5zm10.75 15v-5.25a.75.75 0 0 0-.75-.75h-7.5a.75.75 0 0 0-.75.75v5.25zm-8-15v2.75c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75V4.5z"})],-1)])]),createBaseVNode("button",{onClick:scrollToTop},[...t[48]||(t[48]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 20 20"},[createBaseVNode("path",{d:"M4.207 15.267a.75.75 0 0 1 .026-1.06l5.25-5.001a.75.75 0 0 1 1.034 0l5.25 5a.75.75 0 0 1-1.034 1.087L10 10.784l-4.733 4.51a.75.75 0 0 1-1.06-.027m0-4.998a.75.75 0 0 1 .026-1.06l5.25-5.002a.75.75 0 0 1 1.034 0l5.25 5.001a.75.75 0 0 1-1.034 1.086L10 5.786l-4.733 4.509a.75.75 0 0 1-1.06-.026"})],-1)])]),createBaseVNode("button",{onClick:enableScrollToBottom},[...t[49]||(t[49]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 20 20"},[createBaseVNode("path",{d:"M15.794 8.733a.75.75 0 0 1-.026 1.06l-5.25 5.001a.75.75 0 0 1-1.035 0l-5.25-5a.75.75 0 0 1 1.034-1.087l4.734 4.509l4.733-4.51a.75.75 0 0 1 1.06.027m0-4a.75.75 0 0 1-.026 1.06l-5.25 5.001a.75.75 0 0 1-1.035 0l-5.25-5a.75.75 0 0 1 1.034-1.087l4.734 4.509l4.733-4.51a.75.75 0 0 1 1.06.027"})],-1)])])])]),createVNode(unref(Editor),{modelValue:unref(systemInstruction),"onUpdate:modelValue":t[6]||(t[6]=e=>isRef(systemInstruction)?systemInstruction.value=e:null),style:{width:"100%"},theme:"dark",showCodeRowNumber:!1,preview:unref(Utils).isWidth.value,toolbars:[],onClick:t[7]||(t[7]=withModifiers(()=>{},["stop"]))},null,8,["modelValue","preview"])],4),[[vShow,!hideSystem.value]]),createBaseVNode("div",{style:normalizeStyle([{"margin-top":"40px"},{paddingBottom:isPhone?"80px":"100px"}])},[(openBlock(!0),createElementBlock(Fragment,null,renderList(contents,(e,o)=>(openBlock(),createElementBlock("div",{key:e.id,class:"history"},[createBaseVNode("div",{class:normalizeClass(["info",e.role]),onClick:[withModifiers(e=>selectFirst(o),["shift","stop"]),t=>e.hide=!e.hide],onContextmenu:withModifiers(t=>rightClickMenu.show(t,e),["prevent"])},[createBaseVNode("div",_hoisted_9,[createBaseVNode("div",_hoisted_10,[createBaseVNode("p",{onClick:withModifiers(t=>switchRole(e),["stop"])},toDisplayString("model"===e.role?"模型":"用户"),9,_hoisted_11),"model"===e.role?(openBlock(),createElementBlock(Fragment,{key:0},[e.networkTime?(openBlock(),createElementBlock("div",_hoisted_12,[createVNode(IconTime),createBaseVNode("span",null,toDisplayString(e.networkTime),1),withDirectives(createBaseVNode("span",null,"/ "+toDisplayString(e.generatingTime),513),[[vShow,e.generatingTime]])])):createCommentVNode("",!0),e.finishReason?(openBlock(),createElementBlock("div",_hoisted_13,[t[50]||(t[50]=createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M12.0001 1.99902C17.5238 1.99902 22.0016 6.47687 22.0016 12.0006C22.0016 17.5243 17.5238 22.0021 12.0001 22.0021C6.47638 22.0021 1.99854 17.5243 1.99854 12.0006C1.99854 6.47687 6.47638 1.99902 12.0001 1.99902ZM12.0001 3.49902C7.30481 3.49902 3.49854 7.3053 3.49854 12.0006C3.49854 16.6959 7.30481 20.5021 12.0001 20.5021C16.6954 20.5021 20.5016 16.6959 20.5016 12.0006C20.5016 7.3053 16.6954 3.49902 12.0001 3.49902ZM11.9964 10.4996C12.3761 10.4994 12.6901 10.7813 12.74 11.1473L12.7469 11.2491L12.7505 16.7507C12.7508 17.1649 12.4152 17.5009 12.001 17.5012C11.6213 17.5014 11.3073 17.2195 11.2574 16.8535L11.2505 16.7517L11.2469 11.2501C11.2467 10.8359 11.5822 10.4999 11.9964 10.4996ZM12.0005 7.00184C12.5521 7.00184 12.9992 7.44896 12.9992 8.0005C12.9992 8.55205 12.5521 8.99917 12.0005 8.99917C11.449 8.99917 11.0019 8.55205 11.0019 8.0005C11.0019 7.44896 11.449 7.00184 12.0005 7.00184Z"})],-1)),createBaseVNode("p",null,toDisplayString(e.finishReason),1)])):createCommentVNode("",!0)],64)):createCommentVNode("",!0),e.hide?(openBlock(),createElementBlock("svg",_hoisted_14,[...t[51]||(t[51]=[createBaseVNode("path",{d:"M9.49094 4.40235C9.1153 4.14129 8.66749 4 8.20693 4H4.25L4.09595 4.00519C2.92516 4.08436 2 5.05914 2 6.25V17.75L2.00519 17.904C2.08436 19.0748 3.05914 20 4.25 20H19.75L19.904 19.9948C21.0748 19.9156 22 18.9409 22 17.75V8.75L21.9948 8.59595L21.9785 8.43788C21.8266 7.34297 20.8867 6.5 19.75 6.5H12.022L9.64734 4.5215L9.49094 4.40235ZM13.4967 8V10.2451C13.4967 10.6593 13.8325 10.9951 14.2467 10.9951H14.9967V11.9976H14.7467C14.3325 11.9976 13.9967 12.3334 13.9967 12.7476C13.9967 13.1618 14.3325 13.4976 14.7467 13.4976H14.9967V14.9976H14.7467C14.3325 14.9976 13.9967 15.3334 13.9967 15.7476C13.9967 16.1618 14.3325 16.4976 14.7467 16.4976H14.9967V18.5H4.25L4.14823 18.4932C3.78215 18.4435 3.5 18.1297 3.5 17.75V10.499L8.20693 10.5L8.40335 10.4914C8.85906 10.4515 9.29353 10.2733 9.64734 9.9785L12.021 8H13.4967ZM16.4967 18.0004H16.7467C17.1609 18.0004 17.4967 17.6646 17.4967 17.2504C17.4967 16.8362 17.1609 16.5004 16.7467 16.5004H16.4967V15.0004H16.7467C17.1609 15.0004 17.4967 14.6646 17.4967 14.2504C17.4967 13.8362 17.1609 13.5004 16.7467 13.5004H16.4967V10.9951H17.2467C17.6609 10.9951 17.9967 10.6593 17.9967 10.2451V8H19.75L19.8518 8.00685C20.2178 8.05651 20.5 8.3703 20.5 8.75V17.75L20.4932 17.8518C20.4435 18.2178 20.1297 18.5 19.75 18.5H16.4967V18.0004ZM16.4967 8V9.49513L14.9967 9.49513V8H16.4967ZM4.25 5.5H8.20693L8.31129 5.5073C8.44893 5.52664 8.57923 5.58398 8.68706 5.67383L10.578 7.249L8.68706 8.82617L8.60221 8.88738C8.4841 8.96063 8.34729 9 8.20693 9L3.5 8.999V6.25L3.50685 6.14823C3.55651 5.78215 3.8703 5.5 4.25 5.5Z"},null,-1)])])):createCommentVNode("",!0)])]),createBaseVNode("div",{class:"action",style:{"margin-top":"2px"},onClick:t[9]||(t[9]=withModifiers(()=>{},["stop"]))},["model"===e.role?(openBlock(),createElementBlock("button",{key:0,onClick:e=>retry(o)},[...t[52]||(t[52]=[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M13.209 3.10215C12.7138 2.09876 11.283 2.09877 10.7878 3.10215L8.42988 7.87987L3.15735 8.64601C2.05005 8.80691 1.60791 10.1677 2.40916 10.9487L6.2244 14.6676L5.32374 19.9189C5.13459 21.0217 6.29213 21.8627 7.28252 21.342L11.9984 18.8627L16.7143 21.342C17.7047 21.8627 18.8622 21.0217 18.6731 19.9189L17.7724 14.6676L21.5877 10.9487C22.3889 10.1677 21.9468 8.80691 20.8395 8.64601L15.567 7.87987L13.209 3.10215ZM9.74008 8.61443L11.9984 4.03854L14.2568 8.61443C14.4534 9.01288 14.8335 9.28904 15.2732 9.35294L20.323 10.0867L16.6689 13.6486C16.3508 13.9587 16.2056 14.4055 16.2807 14.8435L17.1433 19.8729L12.6266 17.4983C12.2333 17.2915 11.7635 17.2915 11.3702 17.4983L6.85353 19.8729L7.71614 14.8435C7.79125 14.4055 7.64606 13.9587 7.32788 13.6486L3.67382 10.0867L8.72361 9.35294C9.16332 9.28904 9.54344 9.01288 9.74008 8.61443ZM1.16438 3.78102C0.905619 4.10446 0.95806 4.57643 1.28151 4.83519L3.78151 6.83519C4.10495 7.09395 4.57692 7.04151 4.83568 6.71806C5.09444 6.39461 5.042 5.92265 4.71855 5.66389L2.21855 3.66389C1.8951 3.40513 1.42313 3.45757 1.16438 3.78102ZM22.8357 18.2181C23.0945 17.8946 23.042 17.4226 22.7186 17.1639L20.2186 15.1639C19.8951 14.9051 19.4232 14.9576 19.1644 15.281C18.9056 15.6045 18.9581 16.0764 19.2815 16.3352L21.7815 18.3352C22.105 18.5939 22.5769 18.5415 22.8357 18.2181ZM1.28151 17.1639C0.95806 17.4226 0.905619 17.8946 1.16438 18.2181C1.42313 18.5415 1.8951 18.5939 2.21855 18.3352L4.71855 16.3352C5.042 16.0764 5.09444 15.6045 4.83568 15.281C4.57692 14.9576 4.10495 14.9051 3.78151 15.1639L1.28151 17.1639ZM22.8357 3.78102C23.0945 4.10446 23.042 4.57643 22.7186 4.83519L20.2186 6.83519C19.8951 7.09395 19.4232 7.04151 19.1644 6.71806C18.9056 6.39461 18.9581 5.92265 19.2815 5.66389L21.7815 3.66389C22.105 3.40513 22.5769 3.45757 22.8357 3.78102Z"})],-1)])],8,_hoisted_15)):createCommentVNode("",!0),createBaseVNode("button",{onClick:t=>e.edit=!e.edit},[createVNode(IconEdit)],8,_hoisted_16),createBaseVNode("button",{onClick:e=>remove(o)},[createVNode(IconRemove)],8,_hoisted_17),createBaseVNode("button",{onClick:e=>up(o)},[createVNode(IconUp)],8,_hoisted_18),createBaseVNode("button",{onClick:e=>down(o)},[createVNode(_sfc_main$3)],8,_hoisted_19)])],42,_hoisted_8),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.parts,a=>(openBlock(),createElementBlock("div",{style:normalizeStyle({backgroundColor:("model"===e.role?"black":"#333")+" !important"})},[e.thought?(openBlock(),createElementBlock("div",_hoisted_20,[t[53]||(t[53]=createBaseVNode("div",{style:{width:"100%",display:"flex"}},[createBaseVNode("p",{style:{width:"100%","text-align":"center"}},"思考总结")],-1)),t[54]||(t[54]=createBaseVNode("hr",null,null,-1)),createVNode(unref(MdPreview),{modelValue:e.thought,"onUpdate:modelValue":t=>e.thought=t,theme:"dark"},null,8,["modelValue","onUpdate:modelValue"])])):createCommentVNode("",!0),void 0!==a.text?(openBlock(),createElementBlock(Fragment,{key:1},[e.hide?withDirectives((openBlock(),createElementBlock("textarea",{key:0,"onUpdate:modelValue":e=>a.text=e,style:{outline:"none",border:"none","overflow-y":"scroll",resize:"vertical"},onKeydown:withKeys(withModifiers(t=>ctrlEnterEditCompelete(e,o),["ctrl","stop"]),["enter"]),onDblclick:handleDoubleClick},null,40,_hoisted_21)),[[vModelText,a.text,void 0,{lazy:!0}]]):e.edit?(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(e.parts,t=>(openBlock(),createBlock(unref(Editor),{modelValue:t.text,"onUpdate:modelValue":e=>t.text=e,autoFoldThreshold:autoFoldThreshold.value,preview:unref(Utils).isWidth.value,sanitize:markdownSanitize,showCodeRowNumber:!1,toolbars:[],theme:"dark",onKeydown:[withKeys(withModifiers(t=>ctrlEnterEditCompelete(e,o),["ctrl","stop"]),["enter"]),withKeys(withModifiers(t=>e.edit=!e.edit,["alt","stop"]),["enter"])]},null,8,["modelValue","onUpdate:modelValue","autoFoldThreshold","preview","onKeydown"]))),256)):(openBlock(!0),createElementBlock(Fragment,{key:2},renderList(e.parts,t=>(openBlock(),createBlock(unref(MdPreview),{modelValue:t.text,"onUpdate:modelValue":e=>t.text=e,autoFoldThreshold:autoFoldThreshold.value,sanitize:markdownSanitize,showCodeRowNumber:!1,theme:"dark",onClick:t=>isPhone?rightClickMenu.show(t,e):void 0,onContextmenu:withModifiers(t=>isPhone?void 0:rightClickMenu.show(t,e),["prevent"])},null,8,["modelValue","onUpdate:modelValue","autoFoldThreshold","onClick","onContextmenu"]))),256))],64)):(openBlock(),createBlock(_sfc_main$1,{key:2,part:a,isEdit:e.edit},null,8,["part","isEdit"])),e.search?(openBlock(),createElementBlock("div",_hoisted_22,[createBaseVNode("div",_hoisted_23,[t[55]||(t[55]=createBaseVNode("p",{style:{width:"100%","text-align":"center"}},"联网搜索",-1)),createVNode(IconRemove,{onClick:t=>delete e.search},null,8,["onClick"])]),t[57]||(t[57]=createBaseVNode("hr",null,null,-1)),createBaseVNode("div",_hoisted_24,[t[56]||(t[56]=createBaseVNode("span",null,"搜索 ",-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.search.webSearchQueries,e=>(openBlock(),createElementBlock("span",_hoisted_25,toDisplayString(e),1))),256)),createBaseVNode("span",null," 的 "+toDisplayString(e.search.groundingChunks.length)+" 个源：",1)]),createBaseVNode("div",_hoisted_26,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.search.groundingChunks,e=>(openBlock(),createElementBlock("button",_hoisted_27,toDisplayString(e.web.title),1))),256))])])):createCommentVNode("",!0)],4))),256))]))),128))],4)]),createBaseVNode("div",_hoisted_28,[generatingTempData.value?(openBlock(),createElementBlock("div",_hoisted_29,[createBaseVNode("div",{class:"info model",style:normalizeStyle([{bottom:isPhone?"52px":"80px"},{height:"28px"}])},[createBaseVNode("div",_hoisted_30,[createBaseVNode("span",null,toDisplayString(contents.indexOf(generatingDialog.value)),1),createBaseVNode("span",_hoisted_31,[createVNode(IconTime,{style:{height:"20px"}}),createBaseVNode("span",null,toDisplayString(generatingDialog.value.networkTime),1),generatingDialog.value.generatingTime?(openBlock(),createElementBlock("span",_hoisted_32,"/ "+toDisplayString(generatingDialog.value.generatingTime),1)):createCommentVNode("",!0)]),generatingTempData.value?.token?(openBlock(),createElementBlock("span",_hoisted_33,[createVNode(IconToken,{style:{height:"16px"}}),createBaseVNode("span",null,toDisplayString(generatingTempData.value.token),1)])):createCommentVNode("",!0)])],4)])):createCommentVNode("",!0),isPhone?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_34,[createBaseVNode("button",{onClick:t[10]||(t[10]=e=>hideSystem.value=!hideSystem.value)},toDisplayString(hideSystem.value?"显示":"隐藏")+"界面",1),createBaseVNode("button",{onClick:t[11]||(t[11]=e=>autoScrollToBottom.value=!autoScrollToBottom.value)},toDisplayString(autoScrollToBottom.value?"自动":"手动")+"滚动",1)])),createBaseVNode("div",_hoisted_35,[createVNode(unref(Editor),{modelValue:inputPrompt.value,"onUpdate:modelValue":t[12]||(t[12]=e=>inputPrompt.value=e),theme:"dark",showCodeRowNumber:!1,preview:unref(Utils).isWidth.value,toolbars:[],onKeydown:[withKeys(withModifiers(sendMessage,["ctrl","stop"]),["enter"]),withKeys(withModifiers(pushMessage,["alt","stop"]),["enter"])]},null,8,["modelValue","preview","onKeydown"])]),createBaseVNode("div",{class:normalizeClass({"phone-input":isPhone}),style:{display:"flex","justify-content":"space-around","flex-direction":"column","min-width":"80px"}},[createBaseVNode("button",{onClick:sendMessage},toDisplayString(generatingTempData.value?"停止":"生成")+"对话",1)],2)]),rightClickMenu.visible?(openBlock(),createElementBlock("div",{key:0,class:"menu",onClick:t[25]||(t[25]=e=>rightClickMenu.visible=!1),onContextmenu:t[26]||(t[26]=withModifiers(e=>rightClickMenu.visible=!1,["stop"]))},[createBaseVNode("ul",{style:normalizeStyle({left:rightClickMenu.left,top:rightClickMenu.top,bottom:rightClickMenu.bottom}),onClick:t[24]||(t[24]=e=>rightClickMenu.visible=!1)},[createBaseVNode("li",{onClick:t[13]||(t[13]=e=>copyToClipboard(rightClickMenu.content.parts[0].text??JSON.stringify(rightClickMenu.content.parts[0].functionCall)))},[...t[58]||(t[58]=[createBaseVNode("div",null,[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M5.503 4.627L5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.25 2.25 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123M13.128 2c.597 0 1.17.237 1.592.66l4.618 4.62c.422.422.659.995.659 1.591v8.383a2.25 2.25 0 0 1-2.25 2.25H8.752a2.25 2.25 0 0 1-2.25-2.25V4.25A2.25 2.25 0 0 1 8.752 2zM13 3.5H8.752a.75.75 0 0 0-.75.75v13.004c0 .414.336.75.75.75h8.995a.75.75 0 0 0 .75-.75V9.003H15.25a2.25 2.25 0 0 1-2.245-2.095L13 6.754zm1.5 1.061l.001 2.193c0 .38.282.693.648.743l.102.007l2.19-.001z"})])],-1),createBaseVNode("div",{class:"text"},"复制 Markdown",-1)])]),"model"===rightClickMenu.content.role?(openBlock(),createElementBlock("li",{key:0,onClick:t[14]||(t[14]=e=>retry(rightClickMenu.index))},[...t[59]||(t[59]=[createBaseVNode("div",null,[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M13.209 3.10215C12.7138 2.09876 11.283 2.09877 10.7878 3.10215L8.42988 7.87987L3.15735 8.64601C2.05005 8.80691 1.60791 10.1677 2.40916 10.9487L6.2244 14.6676L5.32374 19.9189C5.13459 21.0217 6.29213 21.8627 7.28252 21.342L11.9984 18.8627L16.7143 21.342C17.7047 21.8627 18.8622 21.0217 18.6731 19.9189L17.7724 14.6676L21.5877 10.9487C22.3889 10.1677 21.9468 8.80691 20.8395 8.64601L15.567 7.87987L13.209 3.10215ZM9.74008 8.61443L11.9984 4.03854L14.2568 8.61443C14.4534 9.01288 14.8335 9.28904 15.2732 9.35294L20.323 10.0867L16.6689 13.6486C16.3508 13.9587 16.2056 14.4055 16.2807 14.8435L17.1433 19.8729L12.6266 17.4983C12.2333 17.2915 11.7635 17.2915 11.3702 17.4983L6.85353 19.8729L7.71614 14.8435C7.79125 14.4055 7.64606 13.9587 7.32788 13.6486L3.67382 10.0867L8.72361 9.35294C9.16332 9.28904 9.54344 9.01288 9.74008 8.61443ZM1.16438 3.78102C0.905619 4.10446 0.95806 4.57643 1.28151 4.83519L3.78151 6.83519C4.10495 7.09395 4.57692 7.04151 4.83568 6.71806C5.09444 6.39461 5.042 5.92265 4.71855 5.66389L2.21855 3.66389C1.8951 3.40513 1.42313 3.45757 1.16438 3.78102ZM22.8357 18.2181C23.0945 17.8946 23.042 17.4226 22.7186 17.1639L20.2186 15.1639C19.8951 14.9051 19.4232 14.9576 19.1644 15.281C18.9056 15.6045 18.9581 16.0764 19.2815 16.3352L21.7815 18.3352C22.105 18.5939 22.5769 18.5415 22.8357 18.2181ZM1.28151 17.1639C0.95806 17.4226 0.905619 17.8946 1.16438 18.2181C1.42313 18.5415 1.8951 18.5939 2.21855 18.3352L4.71855 16.3352C5.042 16.0764 5.09444 15.6045 4.83568 15.281C4.57692 14.9576 4.10495 14.9051 3.78151 15.1639L1.28151 17.1639ZM22.8357 3.78102C23.0945 4.10446 23.042 4.57643 22.7186 4.83519L20.2186 6.83519C19.8951 7.09395 19.4232 7.04151 19.1644 6.71806C18.9056 6.39461 18.9581 5.92265 19.2815 5.66389L21.7815 3.66389C22.105 3.40513 22.5769 3.45757 22.8357 3.78102Z"})])],-1),createBaseVNode("div",{class:"text"},"重试",-1)])])):createCommentVNode("",!0),createBaseVNode("li",{onClick:t[15]||(t[15]=e=>remove(rightClickMenu.index))},[createBaseVNode("div",null,[createVNode(IconRemove)]),t[60]||(t[60]=createBaseVNode("div",{class:"text"},"删除",-1))]),createBaseVNode("li",{onClick:t[16]||(t[16]=e=>rightClickMenu.content.edit=!rightClickMenu.content.edit)},[createBaseVNode("div",null,[createVNode(IconEdit)]),createBaseVNode("div",_hoisted_36,toDisplayString(rightClickMenu.content.edit?"完成编辑":"编辑"),1)]),createBaseVNode("li",{onClick:t[17]||(t[17]=e=>contents[rightClickMenu.index].hide=!0)},[...t[61]||(t[61]=[createStaticVNode('<div><svg width="24" height="24" viewBox="0 0 24 24"><path d="M11.75 2C12.1642 2 12.5 2.33579 12.5 2.75V6.93934L13.7197 5.71967C14.0126 5.42678 14.4874 5.42678 14.7803 5.71967C15.0732 6.01256 15.0732 6.48744 14.7803 6.78033L12.2803 9.28033C11.9874 9.57322 11.5126 9.57322 11.2197 9.28033L8.71967 6.78033C8.42678 6.48744 8.42678 6.01256 8.71967 5.71967C9.01256 5.42678 9.48744 5.42678 9.78033 5.71967L11 6.93934V2.75C11 2.33579 11.3358 2 11.75 2Z"></path><path d="M4 11.75C4 11.3358 4.33579 11 4.75 11H19.25C19.6642 11 20 11.3358 20 11.75C20 12.1642 19.6642 12.5 19.25 12.5H4.75C4.33579 12.5 4 12.1642 4 11.75Z"></path><path d="M13.7197 17.7803C14.0126 18.0732 14.4874 18.0732 14.7803 17.7803C15.0732 17.4874 15.0732 17.0126 14.7803 16.7197L12.2803 14.2197C11.9874 13.9268 11.5126 13.9268 11.2197 14.2197L8.71967 16.7197C8.42678 17.0126 8.42678 17.4874 8.71967 17.7803C9.01256 18.0732 9.48744 18.0732 9.78033 17.7803L11 16.5607L11 21.25C11 21.6642 11.3358 22 11.75 22C12.1642 22 12.5 21.6642 12.5 21.25V16.5607L13.7197 17.7803Z"></path></svg></div><div class="text">折叠</div>',2)])]),createBaseVNode("li",{onClick:t[18]||(t[18]=e=>insert(rightClickMenu.index))},[createBaseVNode("div",null,[createVNode(IconInsert)]),t[62]||(t[62]=createBaseVNode("div",{class:"text"},"插入",-1))]),createBaseVNode("li",{onClick:t[19]||(t[19]=e=>insertThinkingPrompt(rightClickMenu.index))},[createBaseVNode("div",null,[createVNode(IconInsert)]),t[63]||(t[63]=createBaseVNode("div",{class:"text"},"加入思考提示词",-1))]),createBaseVNode("li",{onClick:t[20]||(t[20]=e=>up(rightClickMenu.index))},[createBaseVNode("div",null,[createVNode(IconUp)]),t[64]||(t[64]=createBaseVNode("div",{class:"text"},"上移",-1))]),createBaseVNode("li",{onClick:t[21]||(t[21]=e=>down(rightClickMenu.index))},[createBaseVNode("div",null,[createVNode(_sfc_main$3)]),t[65]||(t[65]=createBaseVNode("div",{class:"text"},"下移",-1))]),createBaseVNode("li",{onClick:t[22]||(t[22]=(...e)=>rightClickMenu.appendToPrevious&&rightClickMenu.appendToPrevious(...e))},[...t[66]||(t[66]=[createBaseVNode("div",null,[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M13.72 5.78a.75.75 0 1 0 1.06-1.06l-2.5-2.5a.75.75 0 0 0-1.06 0l-2.5 2.5a.75.75 0 0 0 1.06 1.06L11 4.56v4.19a.75.75 0 0 0 1.5 0V4.56zM4 11.75a.75.75 0 0 1 .75-.75h14.5a.75.75 0 0 1 0 1.5H4.75a.75.75 0 0 1-.75-.75m8.5 3a.75.75 0 0 0-1.5 0v4.69l-1.22-1.22a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l2.5-2.5a.75.75 0 1 0-1.06-1.06l-1.22 1.22z"})])],-1),createBaseVNode("div",{class:"text"},"拼接",-1)])]),createBaseVNode("li",{onClick:t[23]||(t[23]=(...e)=>rightClickMenu.switchFilter&&rightClickMenu.switchFilter(...e))},[...t[67]||(t[67]=[createBaseVNode("div",null,[createBaseVNode("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[createBaseVNode("path",{d:"M13.72 5.78a.75.75 0 1 0 1.06-1.06l-2.5-2.5a.75.75 0 0 0-1.06 0l-2.5 2.5a.75.75 0 0 0 1.06 1.06L11 4.56v4.19a.75.75 0 0 0 1.5 0V4.56zM4 11.75a.75.75 0 0 1 .75-.75h14.5a.75.75 0 0 1 0 1.5H4.75a.75.75 0 0 1-.75-.75m8.5 3a.75.75 0 0 0-1.5 0v4.69l-1.22-1.22a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l2.5-2.5a.75.75 0 1 0-1.06-1.06l-1.22 1.22z"})])],-1),createBaseVNode("div",{class:"text"},"切换过滤",-1)])])],4)],32)):createCommentVNode("",!0),withDirectives(createBaseVNode("aside",{onMouseenter:t[42]||(t[42]=e=>showSidebar.value=!0),onMouseleave:t[43]||(t[43]=e=>showSidebar.value=!1),style:normalizeStyle([{position:"fixed",top:"40px","background-color":"#282828","z-index":"9999",width:"288px"},{right:showSidebar.value?"-16px":"-288px",height:isPhone?"calc(100vh - 92px)":"calc(100vh - 115px)"}])},[createBaseVNode("button",{style:normalizeStyle([{border:"2px solid #666",position:"absolute",top:"50%",left:"0",transform:"translate(-100%, -50%)","background-color":"#282828"},{opacity:showSidebar.value?0:1}])},[...t[68]||(t[68]=[createBaseVNode("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px"},[createBaseVNode("path",{d:"M216-144q-29.7 0-50.85-21.15Q144-186.3 144-216v-528q0-29.7 21.15-50.85Q186.3-816 216-816h528q29.7 0 50.85 21.15Q816-773.7 816-744v528q0 29.7-21.15 50.85Q773.7-144 744-144H216Zm264-96h240v-480H480v480Z"})],-1)])],4),createBaseVNode("div",_hoisted_37,[createBaseVNode("div",_hoisted_38,[createBaseVNode("div",null,[createBaseVNode("button",{onClick:changeShowSystem},"系统提示词")]),t[69]||(t[69]=createBaseVNode("hr",null,null,-1)),createBaseVNode("div",null,[createBaseVNode("button",{onClick:t[27]||(t[27]=e=>clear(!0))},"清空对话"),createBaseVNode("button",{onClick:importHistory},"导入对话"),createBaseVNode("button",{onClick:exportHistory},"导出对话"),createBaseVNode("button",{onClick:upgradeToOnline},"升级在线对话")]),t[70]||(t[70]=createBaseVNode("hr",null,null,-1)),createBaseVNode("div",null,[createBaseVNode("button",{onClick:t[28]||(t[28]=e=>filterWindowShow.value=!0)},"文字替换器"),createBaseVNode("button",{onClick:t[29]||(t[29]=e=>fastTextWindowShow.value=!0)},"预设回应"),createBaseVNode("button",{onClick:t[30]||(t[30]=e=>notepadWindowShow.value=!0)},"记事本"),createBaseVNode("button",{onClick:t[31]||(t[31]=(...e)=>unref(Gemini).changeKey&&unref(Gemini).changeKey(...e))},"换 Key")])]),createBaseVNode("div",_hoisted_39,[t[71]||(t[71]=createBaseVNode("p",{style:{"flex-shrink":"0"}},"折叠代码行数",-1)),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[32]||(t[32]=e=>autoFoldThreshold.value=e),style:{"flex-grow":"1",width:"100%","text-align":"right"}},null,512),[[vModelText,autoFoldThreshold.value,void 0,{number:!0}]])]),t[81]||(t[81]=createBaseVNode("hr",null,null,-1)),createBaseVNode("div",_hoisted_40,[createBaseVNode("div",_hoisted_41,[t[72]||(t[72]=createBaseVNode("p",{style:{"flex-shrink":"0"}},"模型",-1)),withDirectives(createBaseVNode("select",{"onUpdate:modelValue":t[33]||(t[33]=e=>isRef(selectModel)?selectModel.value=e:null),style:{"flex-grow":"1",width:"100%"}},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(Gemini).modelList,e=>(openBlock(),createElementBlock("option",{value:e},toDisplayString(e.name),9,_hoisted_42))),256))],512),[[vModelSelect,unref(selectModel)]])]),createBaseVNode("div",_hoisted_43,[t[73]||(t[73]=createBaseVNode("p",{style:{"flex-shrink":"0"}},"使用 Studio API",-1)),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[34]||(t[34]=e=>unref(selectModel).studio=e),style:{width:"8%"},type:"checkbox"},null,512),[[vModelCheckbox,unref(selectModel).studio]])]),createBaseVNode("div",{class:"text",style:{"align-items":"center",cursor:"pointer",margin:"4px 0"},onClick:countToken},[t[74]||(t[74]=createBaseVNode("p",null,"Input",-1)),createBaseVNode("span",null,[createTextVNode(toDisplayString(tokenCount.value),1),createBaseVNode("span",_hoisted_44," / "+toDisplayString(unref(selectModel).inputTokenLimit),1)])]),createBaseVNode("div",_hoisted_45,[t[75]||(t[75]=createBaseVNode("p",null,"Output",-1)),createBaseVNode("div",_hoisted_46,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[35]||(t[35]=e=>unref(generationConfig).maxOutputTokens=e),style:{width:"calc(100% - 60px)","text-align":"right"}},null,512),[[vModelText,unref(generationConfig).maxOutputTokens,void 0,{number:!0}]]),createBaseVNode("span",_hoisted_47,"/ "+toDisplayString(unref(selectModel).outputTokenLimit),1)])])]),createBaseVNode("div",_hoisted_48,[createBaseVNode("div",_hoisted_49,[t[76]||(t[76]=createBaseVNode("p",{style:{"flex-shrink":"0"}},"联网搜索",-1)),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[36]||(t[36]=e=>unref(generationConfig).google=e),style:{width:"10%"},type:"checkbox"},null,512),[[vModelCheckbox,unref(generationConfig).google]])]),createBaseVNode("button",{style:{"background-color":"#444"},onClick:t[37]||(t[37]=e=>functionDeclarationWindowShow.value=!0)},"函数编辑器")]),createBaseVNode("div",_hoisted_50,[createBaseVNode("div",_hoisted_51,[t[77]||(t[77]=createBaseVNode("p",null,"Temperature",-1)),createBaseVNode("div",null,[createBaseVNode("span",_hoisted_52,[createTextVNode(toDisplayString(unref(generationConfig).temperature),1),createBaseVNode("span",_hoisted_53," / "+toDisplayString(unref(selectModel).maxTemperature),1)])])]),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[38]||(t[38]=e=>unref(generationConfig).temperature=e),max:unref(selectModel).maxTemperature,min:"0",step:"0.01",type:"range",style:{"margin-right":"8px",width:"100%",display:"block"}},null,8,_hoisted_54),[[vModelText,unref(generationConfig).temperature,void 0,{number:!0}]]),createBaseVNode("div",_hoisted_55,[t[78]||(t[78]=createBaseVNode("p",null,"Top P",-1)),createBaseVNode("span",_hoisted_56,toDisplayString(unref(generationConfig).topP),1)]),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[39]||(t[39]=e=>unref(generationConfig).topP=e),max:"1",min:"0",step:"0.01",type:"range",style:{"margin-right":"8px",width:"100%",display:"block"}},null,512),[[vModelText,unref(generationConfig).topP,void 0,{number:!0}]]),createBaseVNode("div",_hoisted_57,[t[79]||(t[79]=createBaseVNode("p",{style:{"flex-shrink":"0"}},"思考 Token 上限",-1)),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[40]||(t[40]=e=>unref(generationConfig).thinkingConfig.thinkingBudget=e),style:{"flex-grow":"1",width:"100%","text-align":"right"}},null,512),[[vModelText,unref(generationConfig).thinkingConfig.thinkingBudget,void 0,{number:!0}]])])]),createBaseVNode("div",_hoisted_58,[createBaseVNode("div",_hoisted_59,[t[80]||(t[80]=createBaseVNode("p",{style:{"flex-shrink":"0"}},"启用生成动画",-1)),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[41]||(t[41]=e=>enableGenerateAnimation.value=e),type:"checkbox",style:{width:"10%"}},null,512),[[vModelCheckbox,enableGenerateAnimation.value]])])])])],36),[[vShow,!hideSystem.value]])])],64))}});export{_sfc_main as _};
