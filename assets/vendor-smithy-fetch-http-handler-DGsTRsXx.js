import{b as t}from"./vendor-smithy-querystring-builder-BeoDXywM.js";import{H as e}from"./vendor-smithy-protocol-http-BM_qqgGS.js";import{f as o}from"./vendor-smithy-util-base64-Cwpq7CWn.js";function n(t,e){return new Request(t,e)}function r(t=0){return new Promise((e,o)=>{t&&setTimeout(()=>{const e=new Error(`Request did not complete within ${t} ms`);e.name="TimeoutError",o(e)},t)})}const s={supported:void 0};class i{static create(t){return"function"==typeof t?.handle?t:new i(t)}constructor(t){"function"==typeof t?this.configProvider=t().then(t=>t||{}):(this.config=t??{},this.configProvider=Promise.resolve(this.config)),void 0===s.supported&&(s.supported=Boolean("undefined"!=typeof Request&&"keepalive"in n("https://[::1]")))}destroy(){}async handle(o,{abortSignal:i,requestTimeout:a}={}){this.config||(this.config=await this.configProvider);const c=a??this.config.requestTimeout,u=!0===this.config.keepAlive,d=this.config.credentials;if(i?.aborted){const t=new Error("Request aborted");return t.name="AbortError",Promise.reject(t)}let f=o.path;const l=t(o.query||{});l&&(f+=`?${l}`),o.fragment&&(f+=`#${o.fragment}`);let h="";null==o.username&&null==o.password||(h=`${o.username??""}:${o.password??""}@`);const{port:p,method:y}=o,m=`${o.protocol}//${h}${o.hostname}${p?`:${p}`:""}${f}`,w="GET"===y||"HEAD"===y?void 0:o.body,b={body:w,headers:new Headers(o.headers),method:y,credentials:d};this.config?.cache&&(b.cache=this.config.cache),w&&(b.duplex="half"),"undefined"!=typeof AbortController&&(b.signal=i),s.supported&&(b.keepalive=u),"function"==typeof this.config.requestInit&&Object.assign(b,this.config.requestInit(o));let $=()=>{};const v=n(m,b),E=[fetch(v).then(t=>{const o=t.headers,n={};for(const e of o.entries())n[e[0]]=e[1];return null!=t.body?{response:new e({headers:n,reason:t.statusText,statusCode:t.status,body:t.body})}:t.blob().then(o=>({response:new e({headers:n,reason:t.statusText,statusCode:t.status,body:o})}))}),r(c)];return i&&E.push(new Promise((t,e)=>{const o=()=>{const t=new Error("Request aborted");t.name="AbortError",e(t)};if("function"==typeof i.addEventListener){const t=i;t.addEventListener("abort",o,{once:!0}),$=()=>t.removeEventListener("abort",o)}else i.onabort=o})),Promise.race(E).finally($)}updateHttpClientConfig(t,e){this.config=void 0,this.configProvider=this.configProvider.then(o=>(o[t]=e,o))}httpHandlerConfigs(){return this.config??{}}}const a=async t=>"function"==typeof Blob&&t instanceof Blob||"Blob"===t.constructor?.name?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await t.arrayBuffer()):async function(t){const e=await function(t){return new Promise((e,o)=>{const n=new FileReader;n.onloadend=()=>{if(2!==n.readyState)return o(new Error("Reader aborted too early"));const t=n.result??"",r=t.indexOf(","),s=r>-1?r+1:t.length;e(t.substring(s))},n.onabort=()=>o(new Error("Read aborted")),n.onerror=()=>o(n.error),n.readAsDataURL(t)})}(t),n=o(e);return new Uint8Array(n)}(t):async function(t){const e=[],o=t.getReader();let n=!1,r=0;for(;!n;){const{done:t,value:s}=await o.read();s&&(e.push(s),r+=s.length),n=t}const s=new Uint8Array(r);let i=0;for(const a of e)s.set(a,i),i+=a.length;return s}(t);export{i as F,a as s};
