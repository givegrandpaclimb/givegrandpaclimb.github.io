import{N as t,T as e,I as s,P as n,b as r,c as i,d as o}from"./vendor-lezer-common-3JYFuo68.js";import{F as a,P as h,g as l,j as u,k as c,a as f,S as p}from"./vendor-codemirror-state-d-AKQu11.js";import{E as d,V as m,a as g,l as k,D as w}from"./vendor-codemirror-view-BFv1CI2l.js";import{a as v,h as x,t as b,s as y}from"./vendor-lezer-highlight-QzoJ8SKk.js";import{S as P}from"./vendor-style-mod-_NPnILvn.js";var S;const A=new t;function T(t){return a.define({combine:t?e=>e.concat(t):void 0})}const C=new t;class I{constructor(t,e,s=[],n=""){this.data=t,this.name=n,u.prototype.hasOwnProperty("tree")||Object.defineProperty(u.prototype,"tree",{get(){return D(this)}}),this.parser=e,this.extension=[z.of(this),u.languageData.of((t,e,s)=>{let n=O(t,e,s),r=n.type.prop(A);if(!r)return[];let i=t.facet(r),o=n.type.prop(C);if(o){let r=n.resolve(e-n.from,s);for(let e of o)if(e.test(r,t)){let s=t.facet(e.facet);return"replace"==e.type?s:s.concat(i)}}return i})].concat(s)}isActiveAt(t,e,s=-1){return O(t,e,s).type.prop(A)==this.data}findRegions(s){let n=s.facet(z);if((null==n?void 0:n.data)==this.data)return[{from:0,to:s.doc.length}];if(!n||!n.allowsNesting)return[];let r=[],i=(s,n)=>{if(s.prop(A)==this.data)return void r.push({from:n,to:n+s.length});let o=s.prop(t.mounted);if(o){if(o.tree.prop(A)==this.data){if(o.overlay)for(let t of o.overlay)r.push({from:t.from+n,to:t.to+n});else r.push({from:n,to:n+s.length});return}if(o.overlay){let t=r.length;if(i(o.tree,o.overlay[0].from+n),r.length>t)return}}for(let t=0;t<s.children.length;t++){let r=s.children[t];r instanceof e&&i(r,s.positions[t]+n)}};return i(D(s),0),r}get allowsNesting(){return!0}}function O(t,e,n){let r=t.facet(z),i=D(t).topNode;if(!r||r.allowsNesting)for(let o=i;o;o=o.enter(e,n,s.ExcludeBuffers))o.type.isTop&&(i=o);return i}I.setState=f.define();class B extends I{constructor(t,e,s){super(t,e,[],s),this.parser=e}static define(t){let e=T(t.languageData);return new B(e,t.parser.configure({props:[A.add(t=>t.isTop?e:void 0)]}),t.name)}configure(t,e){return new B(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function D(t){let s=t.field(I.state,!1);return s?s.tree:e.empty}class L{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let s=this.cursorPos-this.string.length;return t<s||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-s,e-s)}}let N=null;class j{constructor(t,e,s=[],n,r,i,o,a){this.parser=t,this.state=e,this.fragments=s,this.tree=n,this.treeLen=r,this.viewport=i,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,s,n){return new j(t,s,[],e.empty,0,n,[],null)}startParse(){return this.parser.startParse(new L(this.state.doc),this.fragments)}work(t,s){return null!=s&&s>=this.state.doc.length&&(s=void 0),this.tree!=e.empty&&this.isDone(null!=s?s:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var e;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=s&&(null==this.parse.stoppedAt||this.parse.stoppedAt>s)&&s<this.state.doc.length&&this.parse.stopAt(s);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(i.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(e=this.parse.stoppedAt)&&void 0!==e?e:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=s?s:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(i.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=N;N=this;try{return t()}finally{N=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=R(t,e.from,e.to);return t}changes(t,s){let{fragments:n,tree:r,treeLen:o,viewport:a,skipped:h}=this;if(this.takeTree(),!t.empty){let s=[];if(t.iterChangedRanges((t,e,n,r)=>s.push({fromA:t,toA:e,fromB:n,toB:r})),n=i.applyChanges(n,s),r=e.empty,o=0,a={from:t.mapPos(a.from,-1),to:t.mapPos(a.to,1)},this.skipped.length){h=[];for(let e of this.skipped){let s=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);s<n&&h.push({from:s,to:n})}}}return new j(this.parser,s,n,r,o,a,h,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:e,to:n}=this.skipped[s];e<t.to&&n>t.from&&(this.fragments=R(this.fragments,e,n),this.skipped.splice(s--,1))}return!(this.skipped.length>=e||(this.reset(),0))}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends n{createParse(s,n,i){let o=i[0].from,a=i[i.length-1].to;return{parsedPos:o,advance(){let s=N;if(s){for(let t of i)s.tempSkipped.push(t);t&&(s.scheduleOn=s.scheduleOn?Promise.all([s.scheduleOn,t]):t)}return this.parsedPos=a,new e(r.none,[],[],a-o)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return N}}function R(t,e,s){return i.applyChanges(t,[{fromA:e,toA:s,fromB:e,toB:s}])}class M{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),s=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,s)||e.takeTree(),new M(e)}static init(t){let e=Math.min(3e3,t.doc.length),s=j.create(t.facet(z).parser,t,{from:0,to:e});return s.work(20,e)||s.takeTree(),new M(s)}}I.state=p.define({create:M.init,update(t,e){for(let s of e.effects)if(s.is(I.setState))return s.value;return e.startState.facet(z)!=e.state.facet(z)?M.init(e.state):t.apply(e)}});let E=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(E=t=>{let e=-1,s=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(s):cancelIdleCallback(e)});const V="undefined"!=typeof navigator&&(null===(S=navigator.scheduling)||void 0===S?void 0:S.isInputPending)?()=>navigator.scheduling.isInputPending():null,W=m.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(I.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(I.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=E(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:n}}=this.view,r=s.field(I.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let i=Date.now()+Math.min(this.chunkBudget,100,t&&!V?Math.max(25,t.timeRemaining()-5):1e9),o=r.context.treeLen<n&&s.doc.length>n+1e3,a=r.context.work(()=>V&&V()||Date.now()>i,n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:I.setState.of(new M(r.context))})),this.chunkBudget>0&&(!a||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(t=>k(this.view.state,t)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),z=a.define({combine:t=>t.length?t[0]:null,enables:t=>[I.state,W,d.contentAttributes.compute([t],e=>{let s=e.facet(t);return s&&s.name?{"data-language":s.name}:{}})]});class F{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}class U{constructor(t,e,s,n,r,i=void 0){this.name=t,this.alias=e,this.extensions=s,this.filename=n,this.loadFunc=r,this.support=i,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(t=>this.support=t,t=>{throw this.loading=null,t}))}static of(t){let{load:e,support:s}=t;if(!e){if(!s)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(s)}return new U(t.name,(t.alias||[]).concat(t.name).map(t=>t.toLowerCase()),t.extensions||[],t.filename,e,s)}static matchFilename(t,e){for(let n of t)if(n.filename&&n.filename.test(e))return n;let s=/\.([^.]+)$/.exec(e);if(s)for(let n of t)if(n.extensions.indexOf(s[1])>-1)return n;return null}static matchLanguageName(t,e,s=!0){e=e.toLowerCase();for(let n of t)if(n.alias.some(t=>t==e))return n;if(s)for(let n of t)for(let t of n.alias){let s=e.indexOf(t);if(s>-1&&(t.length>2||!/\w/.test(e[s-1])&&!/\w/.test(e[s+t.length])))return n}return null}}const q=a.define(),G=a.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function $(t){let e=t.facet(G);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function H(t,e){let s="",n=t.tabSize,r=t.facet(G)[0];if("\t"==r){for(;e>=n;)s+="\t",e-=n;r=" "}for(let i=0;i<e;i++)s+=r;return s}function J(t,e){t instanceof u&&(t=new Y(t));for(let n of t.state.facet(q)){let s=n(t,e);if(void 0!==s)return s}let s=D(t.state);return s.length>=e?function(t,e,s){let n=e.resolveStack(s),r=e.resolveInner(s,-1).resolve(s,0).enterUnfinishedNodesBefore(s);if(r!=n.node){let t=[];for(let e=r;e&&!(e.from<n.node.from||e.to>n.node.to||e.from==n.node.from&&e.type==n.node.type);e=e.parent)t.push(e);for(let e=t.length-1;e>=0;e--)n={node:t[e],next:n}}return K(n,t,s)}(t,s,e):null}class Y{constructor(t,e={}){this.state=t,this.options=e,this.unit=$(t)}lineAt(t,e=1){let s=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:r}=this.options;return null!=n&&n>=s.from&&n<=s.to?r&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:s.text.slice(n-s.from),from:n}:{text:s.text.slice(0,n-s.from),from:s.from}:s}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:s,from:n}=this.lineAt(t,e);return s.slice(t-n,Math.min(s.length,t+100-n))}column(t,e=1){let{text:s,from:n}=this.lineAt(t,e),r=this.countColumn(s,t-n),i=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return i>-1&&(r+=i-this.countColumn(s,s.search(/\S|$/))),r}countColumn(t,e=t.length){return l(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:s,from:n}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let t=r(n);if(t>-1)return t}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const _=new t;function K(t,e,s){for(let n=t;n;n=n.next){let t=Q(n.node);if(t)return t(Z.create(e,s,n))}return 0}function Q(e){let s=e.type.prop(_);if(s)return s;let n,r=e.firstChild;if(r&&(n=r.type.prop(t.closedBy))){let t=e.lastChild,s=t&&n.indexOf(t.name)>-1;return e=>st(e,!0,1,void 0,s&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(e)?t.from:void 0)}return null==e.parent?X:null}function X(){return 0}class Z extends Y{constructor(t,e,s){super(t.state,t.options),this.base=t,this.pos=e,this.context=s}get node(){return this.context.node}static create(t,e,s){return new Z(t,e,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let s=t.resolve(e.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(tt(s,t))break;e=this.state.doc.lineAt(s.from)}return this.lineIndent(e.from)}continue(){return K(this.context.next,this.base,this.pos)}}function tt(t,e){for(let s=e;s;s=s.parent)if(t==s)return!0;return!1}function et({closing:t,align:e=!0,units:s=1}){return n=>st(n,e,s,t)}function st(t,e,s,n,r){let i=t.textAfter,o=i.match(/^\s*/)[0].length,a=n&&i.slice(o,o+n.length)==n||r==t.pos+o,h=e?function(t){let e=t.node,s=e.childAfter(e.from),n=e.lastChild;if(!s)return null;let r=t.options.simulateBreak,i=t.state.doc.lineAt(s.from),o=null==r||r<=i.from?i.to:Math.min(i.to,r);for(let a=s.to;;){let t=e.childAfter(a);if(!t||t==n)return null;if(!t.type.isSkipped){if(t.from>=o)return null;let e=/^ */.exec(i.text.slice(s.to-i.from))[0].length;return{from:s.from,to:s.to+e}}a=t.to}}(t):null;return h?a?t.column(h.from):t.column(h.to):t.baseIndent+(a?0:t.unit*s)}const nt=t=>t.baseIndent;function rt({except:t,units:e=1}={}){return s=>{let n=t&&t.test(s.textAfter);return s.baseIndent+(n?0:e*s.unit)}}const it=a.define(),ot=new t;function at(t){let e=t.firstChild,s=t.lastChild;return e&&e.to<s.from?{from:e.to,to:s.type.isError?t.to:s.from}:null}class ht{constructor(t,e){let s;function n(t){let e=P.newName();return(s||(s=Object.create(null)))["."+e]=t,e}this.specs=t;const r="string"==typeof e.all?e.all:e.all?n(e.all):void 0,i=e.scope;this.scope=i instanceof I?t=>t.prop(A)==i.data:i?t=>t==i:void 0,this.style=v(t.map(t=>({tag:t.tag,class:t.class||n(Object.assign({},t,{tag:null}))})),{all:r}).style,this.module=s?new P(s):null,this.themeType=e.themeType}static define(t,e){return new ht(t,e||{})}}const lt=a.define(),ut=a.define({combine:t=>t.length?[t[0]]:null});function ct(t){let e=t.facet(lt);return e.length?e:t.facet(ut)}function ft(t,e){let s,n=[dt];return t instanceof ht&&(t.module&&n.push(d.styleModule.of(t.module)),s=t.themeType),s?n.push(lt.computeN([d.darkTheme],e=>e.facet(d.darkTheme)==("dark"==s)?[t]:[])):n.push(lt.of(t)),n}class pt{constructor(t){this.markCache=Object.create(null),this.tree=D(t.state),this.decorations=this.buildDeco(t,ct(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=D(t.state),s=ct(t.state),n=s!=ct(t.startState),{viewport:r}=t.view,i=t.changes.mapPos(this.decoratedTo,1);e.length<r.to&&!n&&e.type==this.tree.type&&i>=r.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=i):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,s),this.decoratedTo=r.to)}buildDeco(t,e){if(!e||!this.tree.length)return g.none;let s=new c;for(let{from:n,to:r}of t.visibleRanges)x(this.tree,e,(t,e,n)=>{s.add(t,e,this.markCache[n]||(this.markCache[n]=g.mark({class:n})))},n,r);return s.finish()}}const dt=h.high(m.fromClass(pt,{decorations:t=>t.decorations})),mt=new t;function gt(e,s,n){let r=e.prop(s<0?t.openedBy:t.closedBy);if(r)return r;if(1==e.name.length){let t=n.indexOf(e.name);if(t>-1&&t%2==(s<0?1:0))return[n[t+s]]}return null}function kt(t){let e=t.type.prop(mt);return e?e(t.node):t}function wt(t,e,s,n={}){let r=n.maxScanDistance||1e4,i=n.brackets||"()[]{}",o=D(t),a=o.resolveInner(e,s);for(let h=a;h;h=h.parent){let t=gt(h.type,s,i);if(t&&h.from<h.to){let n=kt(h);if(n&&(s>0?e>=n.from&&e<n.to:e>n.from&&e<=n.to))return vt(0,0,s,h,n,t,i)}}return function(t,e,s,n,r,i,o){let a=s<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),h=o.indexOf(a);if(h<0||h%2==0!=s>0)return null;let l={from:s<0?e-1:e,to:s>0?e+1:e},u=t.doc.iterRange(e,s>0?t.doc.length:0),c=0;for(let f=0;!u.next().done&&f<=i;){let t=u.value;s<0&&(f+=t.length);let i=e+f*s;for(let e=s>0?0:t.length-1,a=s>0?t.length:-1;e!=a;e+=s){let a=o.indexOf(t[e]);if(!(a<0||n.resolveInner(i+e,1).type!=r))if(a%2==0==s>0)c++;else{if(1==c)return{start:l,end:{from:i+e,to:i+e+1},matched:a>>1==h>>1};c--}}s>0&&(f+=t.length)}return u.done?{start:l,matched:!1}:null}(t,e,s,o,a.type,r,i)}function vt(t,e,s,n,r,i,o){let a=n.parent,h={from:r.from,to:r.to},l=0,u=null==a?void 0:a.cursor();if(u&&(s<0?u.childBefore(n.from):u.childAfter(n.to)))do{if(s<0?u.to<=n.from:u.from>=n.to){if(0==l&&i.indexOf(u.type.name)>-1&&u.from<u.to){let t=kt(u);return{start:h,end:t?{from:t.from,to:t.to}:void 0,matched:!0}}if(gt(u.type,s,o))l++;else if(gt(u.type,-s,o)){if(0==l){let t=kt(u);return{start:h,end:t&&t.from<t.to?{from:t.from,to:t.to}:void 0,matched:!1}}l--}}}while(s<0?u.prevSibling():u.nextSibling());return{start:h,matched:!1}}function xt(t,e,s,n=0,r=0){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);let i=r;for(let o=n;o<e;o++)9==t.charCodeAt(o)?i+=s-i%s:i++;return i}class bt{constructor(t,e,s,n){this.string=t,this.tabSize=e,this.indentUnit=s,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e,s=this.string.charAt(this.pos);if(e="string"==typeof t?s==t:s&&(t instanceof RegExp?t.test(s):t(s)),e)return++this.pos,s}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=xt(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var t;return null!==(t=this.overrideIndent)&&void 0!==t?t:xt(this.string,null,this.tabSize)}match(t,e,s){if("string"==typeof t){let n=t=>s?t.toLowerCase():t;return n(this.string.substr(this.pos,t.length))==n(t)?(!1!==e&&(this.pos+=t.length),!0):null}{let s=this.string.slice(this.pos).match(t);return s&&s.index>0?null:(s&&!1!==e&&(this.pos+=s[0].length),s)}}current(){return this.string.slice(this.start,this.pos)}}function yt(t){if("object"!=typeof t)return t;let e={};for(let s in t){let n=t[s];e[s]=n instanceof Array?n.slice():n}return e}const Pt=new WeakMap;class St extends I{constructor(e){let s,i=T(e.languageData),o={name:(a=e).name||"",token:a.token,blankLine:a.blankLine||(()=>{}),startState:a.startState||(()=>!0),copyState:a.copyState||yt,indent:a.indent||(()=>null),languageData:a.languageData||{},tokenTable:a.tokenTable||Ot,mergeTokens:!1!==a.mergeTokens};var a;super(i,new class extends n{createParse(t,e,n){return new Ct(s,t,e,n)}},[],e.name),this.topNode=function(t,e){let s=r.define({id:Bt.length,name:"Document",props:[A.add(()=>t),_.add(()=>t=>e.getIndent(t))],top:!0});return Bt.push(s),s}(i,this),s=this,this.streamParser=o,this.stateAfter=new t({perNode:!0}),this.tokenTable=e.tokenTable?new Rt(o.tokenTable):Mt}static define(t){return new St(t)}getIndent(t){let e,{overrideIndentation:s}=t.options;s&&(e=Pt.get(t.state),null!=e&&e<t.pos-1e4&&(e=void 0));let n,r,i=At(this,t.node.tree,t.node.from,t.node.from,null!=e?e:t.pos);if(i?(r=i.state,n=i.pos+1):(r=this.streamParser.startState(t.unit),n=t.node.from),t.pos-n>1e4)return null;for(;n<t.pos;){let e=t.state.doc.lineAt(n),i=Math.min(t.pos,e.to);if(e.length){let n=s?s(e.from):-1,o=new bt(e.text,t.state.tabSize,t.unit,n<0?void 0:n);for(;o.pos<i-e.from;)It(this.streamParser.token,o,r)}else this.streamParser.blankLine(r,t.unit);if(i==t.pos)break;n=e.to+1}let o=t.lineAt(t.pos);return s&&null==e&&Pt.set(t.state,o.from),this.streamParser.indent(r,/^\s*(.*)/.exec(o.text)[1],t)}get allowsNesting(){return!1}}function At(t,s,n,r,i){let o=n>=r&&n+s.length<=i&&s.prop(t.stateAfter);if(o)return{state:t.streamParser.copyState(o),pos:n+s.length};for(let a=s.children.length-1;a>=0;a--){let o=s.children[a],h=n+s.positions[a],l=o instanceof e&&h<i&&At(t,o,h,r,i);if(l)return l}return null}function Tt(t,s,n,r,i){if(i&&n<=0&&r>=s.length)return s;i||0!=n||s.type!=t.topNode||(i=!0);for(let o=s.children.length-1;o>=0;o--){let a,h=s.positions[o],l=s.children[o];if(h<r&&l instanceof e){if(!(a=Tt(t,l,n-h,r-h,i)))break;return i?new e(s.type,s.children.slice(0,o).concat(a),s.positions.slice(0,o+1),h+a.length):a}}return null}class Ct{constructor(t,s,n,r){this.lang=t,this.input=s,this.fragments=n,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let i=j.get(),o=r[0].from,{state:a,tree:h}=function(t,s,n,r,i){for(let e of s){let s,i=e.from+(e.openStart?25:0),o=e.to-(e.openEnd?25:0),a=i<=n&&o>n&&At(t,e.tree,0-e.offset,n,o);if(a&&a.pos<=r&&(s=Tt(t,e.tree,n+e.offset,a.pos+e.offset,!1)))return{state:a.state,tree:s}}return{state:t.streamParser.startState(i?$(i):4),tree:e.empty}}(t,n,o,this.to,null==i?void 0:i.state);this.state=a,this.parsedPos=this.chunkStart=o+h.length;for(let e=0;e<h.children.length;e++)this.chunks.push(h.children[e]),this.chunkPos.push(h.positions[e]);i&&this.parsedPos<i.viewport.from-1e5&&r.some(t=>t.from<=i.viewport.from&&t.to>=i.viewport.from)&&(this.state=this.lang.streamParser.startState($(i.state)),i.skipUntilInView(this.parsedPos,i.viewport.from),this.parsedPos=i.viewport.from),this.moveRangeIndex()}advance(){let t=j.get(),e=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),s=Math.min(e,this.chunkStart+2048);for(t&&(s=Math.min(s,t.viewport.to));this.parsedPos<s;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)"\n"==e&&(e="");else{let t=e.indexOf("\n");t>-1&&(e=e.slice(0,t))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),s=t+e.length;for(let n=this.rangeIndex;;){let t=this.ranges[n].to;if(t>=s)break;if(e=e.slice(0,t-(s-e.length)),n++,n==this.ranges.length)break;let r=this.ranges[n].from,i=this.lineAfter(r);e+=i,s=r+i.length}return{line:e,end:s}}skipGapsTo(t,e,s){for(;;){let n=this.ranges[this.rangeIndex].to,r=t+e;if(s>0?n>r:n>=r)break;e+=this.ranges[++this.rangeIndex].from-n}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,s,n){let r=4;if(this.ranges.length>1){e+=n=this.skipGapsTo(e,n,1);let t=this.chunk.length;s+=n=this.skipGapsTo(s,n,-1),r+=this.chunk.length-t}let i=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&4==r&&i>=0&&this.chunk[i]==t&&this.chunk[i+2]==e?this.chunk[i+2]=s:this.chunk.push(t,e,s,r),n}parseLine(t){let{line:e,end:s}=this.nextLine(),n=0,{streamParser:r}=this.lang,i=new bt(e,t?t.state.tabSize:4,t?$(t.state):2);if(i.eol())r.blankLine(this.state,i.indentUnit);else for(;!i.eol();){let t=It(r.token,i,this.state);if(t&&(n=this.emitToken(this.lang.tokenTable.resolve(t),this.parsedPos+i.start,this.parsedPos+i.pos,n)),i.start>1e4)break}this.parsedPos=s,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=e.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Dt,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new e(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new e(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function It(t,e,s){e.start=e.pos;for(let n=0;n<10;n++){let n=t(e,s);if(e.pos>e.start)return n}throw new Error("Stream parser failed to advance stream.")}const Ot=Object.create(null),Bt=[r.none],Dt=new o(Bt),Lt=[],Nt=Object.create(null),jt=Object.create(null);for(let[Wt,zt]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])jt[Wt]=Vt(Ot,zt);class Rt{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),jt)}resolve(t){return t?this.table[t]||(this.table[t]=Vt(this.extra,t)):0}}const Mt=new Rt(Ot);function Et(t,e){Lt.indexOf(t)>-1||Lt.push(t)}function Vt(t,e){let s=[];for(let r of e.split(" ")){let e=[];for(let s of r.split(".")){let n=t[s]||b[s];n?"function"==typeof n?e.length?e=e.map(n):Et(s):e.length?Et(s):e=Array.isArray(n)?n:[n]:Et(s)}for(let t of e)s.push(t)}if(!s.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+s.map(t=>t.id),o=Nt[i];if(o)return o.id;let a=Nt[i]=r.define({id:Bt.length,name:n,props:[y({[n]:s})]});return Bt.push(a),a.id}w.RTL,w.LTR;export{ht as H,Y as I,B as L,j as P,St as S,H as a,$ as b,F as c,_ as d,rt as e,ot as f,J as g,et as h,G as i,nt as j,at as k,mt as l,wt as m,C as n,T as o,I as p,it as q,A as r,D as s,U as t,ft as u};
