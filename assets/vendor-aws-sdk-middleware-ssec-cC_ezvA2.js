const t={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},e=e=>({applyToStack:a=>{var n;a.add((n=e,t=>async e=>{const a={...e.input},o=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const t of o){const e=a[t.target];if(e){let o;"string"==typeof e?r(e,n)?o=n.base64Decoder(e):(o=n.utf8Decoder(e),a[t.target]=n.base64Encoder(o)):(o=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),a[t.target]=n.base64Encoder(o));const s=new n.md5;s.update(o),a[t.hash]=n.base64Encoder(await s.digest())}}return t({...e,input:a})}),t)}});function r(t,e){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t))return!1;try{return 32===e.base64Decoder(t).length}catch{return!1}}export{e as g};
