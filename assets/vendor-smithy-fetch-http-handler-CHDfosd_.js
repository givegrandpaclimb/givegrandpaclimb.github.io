import{b as e}from"./vendor-smithy-querystring-builder-BR37T-9q.js";import{H as t}from"./vendor-smithy-protocol-http-D-24QeOr.js";import{f as o}from"./vendor-smithy-util-base64-BgAHKOKZ.js";function r(e,t){return new Request(e,t)}function n(e=0){return new Promise((t,o)=>{e&&setTimeout(()=>{const t=new Error(`Request did not complete within ${e} ms`);t.name="TimeoutError",o(t)},e)})}const s={supported:void 0};class i{static create(e){return"function"==typeof e?.handle?e:new i(e)}constructor(e){"function"==typeof e?this.configProvider=e().then(e=>e||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),void 0===s.supported&&(s.supported=Boolean("undefined"!=typeof Request&&"keepalive"in r("https://[::1]")))}destroy(){}async handle(o,{abortSignal:i,requestTimeout:a}={}){this.config||(this.config=await this.configProvider);const c=a??this.config.requestTimeout,d=!0===this.config.keepAlive,u=this.config.credentials;if(i?.aborted){const e=new Error("Request aborted");return e.name="AbortError",Promise.reject(e)}let f=o.path;const h=e(o.query||{});h&&(f+=`?${h}`),o.fragment&&(f+=`#${o.fragment}`);let l="";null==o.username&&null==o.password||(l=`${o.username??""}:${o.password??""}@`);const{port:p,method:m}=o,y=`${o.protocol}//${l}${o.hostname}${p?`:${p}`:""}${f}`,g="GET"===m||"HEAD"===m?void 0:o.body,b={body:g,headers:new Headers(o.headers),method:m,credentials:u};this.config?.cache&&(b.cache=this.config.cache),g&&(b.duplex="half"),"undefined"!=typeof AbortController&&(b.signal=i),s.supported&&(b.keepalive=d),"function"==typeof this.config.requestInit&&Object.assign(b,this.config.requestInit(o));let w=()=>{};const v=r(y,b),E=[fetch(v).then(e=>{const o=e.headers,r={};for(const t of o.entries())r[t[0]]=t[1];return null!=e.body?{response:new t({headers:r,reason:e.statusText,statusCode:e.status,body:e.body})}:e.blob().then(o=>({response:new t({headers:r,reason:e.statusText,statusCode:e.status,body:o})}))}),n(c)];return i&&E.push(new Promise((e,t)=>{const o=()=>{const e=new Error("Request aborted");e.name="AbortError",t(e)};if("function"==typeof i.addEventListener){const e=i;e.addEventListener("abort",o,{once:!0}),w=()=>e.removeEventListener("abort",o)}else i.onabort=o})),Promise.race(E).finally(w)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(o=>(o[e]=t,o))}httpHandlerConfigs(){return this.config??{}}}const a=async e=>"function"==typeof Blob&&e instanceof Blob||"Blob"===e.constructor?.name?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):async function(e){const t=await function(e){return new Promise((t,o)=>{const r=new FileReader;r.onloadend=()=>{if(2!==r.readyState)return o(new Error("Reader aborted too early"));const e=r.result??"",n=e.indexOf(","),s=n>-1?n+1:e.length;t(e.substring(s))},r.onabort=()=>o(new Error("Read aborted")),r.onerror=()=>o(r.error),r.readAsDataURL(e)})}(e),r=o(t);return new Uint8Array(r)}(e):async function(e){const t=[],o=e.getReader();let r=!1,n=0;for(;!r;){const{done:e,value:s}=await o.read();s&&(t.push(s),n+=s.length),r=e}const s=new Uint8Array(n);let i=0;for(const a of t)s.set(a,i),i+=a.length;return s}(e);export{i as F,a as s};
