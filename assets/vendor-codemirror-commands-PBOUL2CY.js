import{E as t,g as e,b as r,S as n,F as o,h as i,A as l,T as s,c as u,a as f,C as a,i as c}from"./vendor-codemirror-state-D88w-V9V.js";import{E as h,D as d}from"./vendor-codemirror-view-DVzN21hM.js";import{I as m,g as p,a as k,s as y,m as v,b as w,i as g}from"./vendor-codemirror-language-C3hkV707.js";import{N as A}from"./vendor-lezer-common-QPiu6Hcj.js";function M(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let o=t(e,r);return!!o&&(n(r.update(o)),!0)}}const D=M(V,0),C=M(I,0),E=M((t,e)=>I(t,e,function(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),o=r.to<=n.to?n:t.doc.lineAt(r.to);o.from>n.from&&o.from==r.to&&(o=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let i=e.length-1;i>=0&&e[i].to>n.from?e[i].to=o.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:o.to})}return e}(e)),0);function S(t,e){let r=t.languageDataAt("commentTokens",e,1);return r.length?r[0]:{}}const b=50;function I(t,e,r=e.selection.ranges){let n=r.map(t=>S(e,t.from).block);if(!n.every(t=>t))return null;let o=r.map((t,r)=>function(t,{open:e,close:r},n,o){let i,l,s=t.sliceDoc(n-b,n),u=t.sliceDoc(o,o+b),f=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(u)[0].length,c=s.length-f;if(s.slice(c-e.length,c)==e&&u.slice(a,a+r.length)==r)return{open:{pos:n-f,margin:f&&1},close:{pos:o+a,margin:a&&1}};o-n<=2*b?i=l=t.sliceDoc(n,o):(i=t.sliceDoc(n,n+b),l=t.sliceDoc(o-b,o));let h=/^\s*/.exec(i)[0].length,d=/\s*$/.exec(l)[0].length,m=l.length-d-r.length;return i.slice(h,h+e.length)==e&&l.slice(m,m+r.length)==r?{open:{pos:n+h+e.length,margin:/\s/.test(i.charAt(h+e.length))?1:0},close:{pos:o-d-r.length,margin:/\s/.test(l.charAt(m-1))?1:0}}:null}(e,n[r],t.from,t.to));if(2!=t&&!o.every(t=>t))return{changes:e.changes(r.map((t,e)=>o[e]?[]:[{from:t.from,insert:n[e].open+" "},{from:t.to,insert:" "+n[e].close}]))};if(1!=t&&o.some(t=>t)){let t=[];for(let e,r=0;r<o.length;r++)if(e=o[r]){let o=n[r],{open:i,close:l}=e;t.push({from:i.pos-o.open.length,to:i.pos+i.margin},{from:l.pos-l.margin,to:l.pos+o.close.length})}return{changes:t}}return null}function V(t,e,r=e.selection.ranges){let n=[],o=-1;for(let{from:i,to:l}of r){let t=n.length,r=1e9,s=S(e,i).line;if(s){for(let t=i;t<=l;){let u=e.doc.lineAt(t);if(u.from>o&&(i==l||l>u.from)){o=u.from;let t=/^\s*/.exec(u.text)[0].length,e=t==u.length,i=u.text.slice(t,t+s.length)==s?t:-1;t<u.text.length&&t<r&&(r=t),n.push({line:u,comment:i,token:s,indent:t,empty:e,single:!1})}t=u.to+1}if(r<1e9)for(let e=t;e<n.length;e++)n[e].indent<n[e].line.text.length&&(n[e].indent=r);n.length==t+1&&(n[t].single=!0)}}if(2!=t&&n.some(t=>t.comment<0&&(!t.empty||t.single))){let t=[];for(let{line:e,token:o,indent:i,empty:l,single:s}of n)!s&&l||t.push({from:e.from+i,insert:o+" "});let r=e.changes(t);return{changes:r,selection:e.selection.map(r,1)}}if(1!=t&&n.some(t=>t.comment>=0)){let t=[];for(let{line:e,comment:r,token:o}of n)if(r>=0){let n=e.from+r,i=n+o.length;" "==e.text[i-e.from]&&i++,t.push({from:n,to:i})}return{changes:t}}return null}const U=l.define(),j=l.define(),B=o.define(),R=o.define({combine:t=>u(t,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(r,n)=>t(r,n)||e(r,n)})}),T=n.define({create:()=>X.empty,update(t,e){let r=e.state.facet(R),n=e.annotation(U);if(n){let o=x.fromTransaction(e,n.selection),i=n.side,l=0==i?t.undone:t.done;return l=o?G(l,l.length,r.minDepth,o):W(l,e.startState.selection),new X(0==i?n.rest:l,0==i?l:n.rest)}let o=e.annotation(j);if("full"!=o&&"before"!=o||(t=t.isolate()),!1===e.annotation(s.addToHistory))return e.changes.empty?t:t.addMapping(e.changes.desc);let i=x.fromTransaction(e),l=e.annotation(s.time),u=e.annotation(s.userEvent);return i?t=t.addChanges(i,l,u,r,e):e.selection&&(t=t.addSelection(e.startState.selection,l,u,r.newGroupDelay)),"full"!=o&&"after"!=o||(t=t.isolate()),t},toJSON:t=>({done:t.done.map(t=>t.toJSON()),undone:t.undone.map(t=>t.toJSON())}),fromJSON:t=>new X(t.done.map(x.fromJSON),t.undone.map(x.fromJSON))});function L(t={}){return[T,R.of(t),h.domEventHandlers({beforeinput(t,e){let r="historyUndo"==t.inputType?O:"historyRedo"==t.inputType?z:null;return!!r&&(t.preventDefault(),r(e))}})]}function N(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let o=r.field(T,!1);if(!o)return!1;let i=o.pop(t,r,e);return!!i&&(n(i),!0)}}const O=N(0,!1),z=N(1,!1),J=N(0,!0),$=N(1,!0);class x{constructor(t,e,r,n,o){this.changes=t,this.effects=e,this.mapped=r,this.startSelection=n,this.selectionsAfter=o}setSelAfter(t){return new x(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,r;return{changes:null===(t=this.changes)||void 0===t?void 0:t.toJSON(),mapped:null===(e=this.mapped)||void 0===e?void 0:e.toJSON(),startSelection:null===(r=this.startSelection)||void 0===r?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(t=>t.toJSON())}}static fromJSON(e){return new x(e.changes&&a.fromJSON(e.changes),[],e.mapped&&c.fromJSON(e.mapped),e.startSelection&&t.fromJSON(e.startSelection),e.selectionsAfter.map(t.fromJSON))}static fromTransaction(t,e){let r=P;for(let n of t.startState.facet(B)){let e=n(t);e.length&&(r=r.concat(e))}return!r.length&&t.changes.empty?null:new x(t.changes.invert(t.startState.doc),r,void 0,e||t.startState.selection,P)}static selection(t){return new x(void 0,P,void 0,void 0,t)}}function G(t,e,r,n){let o=e+1>r+20?e-r-1:0,i=t.slice(o,e);return i.push(n),i}function H(t,e){return t.length?e.length?t.concat(e):t:e}const P=[],F=200;function W(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-F));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),G(t,t.length-1,1e9,r.setSelAfter(n)))}return[x.selection([e])]}function Y(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function q(t,e){if(!t.length)return t;let r=t.length,n=P;for(;r;){let o=K(t[r-1],e,n);if(o.changes&&!o.changes.empty||o.effects.length){let e=t.slice(0,r);return e[r-1]=o,e}e=o.mapped,r--,n=o.selectionsAfter}return n.length?[x.selection(n)]:P}function K(t,e,r){let n=H(t.selectionsAfter.length?t.selectionsAfter.map(t=>t.map(e)):P,r);if(!t.changes)return x.selection(n);let o=t.changes.map(e),i=e.mapDesc(t.changes,!0),l=t.mapped?t.mapped.composeDesc(i):i;return new x(o,f.mapEffects(t.effects,e),l,t.startSelection.map(i),n)}const Q=/^(input\.type|delete)($|\.)/;class X{constructor(t,e,r=0,n=void 0){this.done=t,this.undone=e,this.prevTime=r,this.prevUserEvent=n}isolate(){return this.prevTime?new X(this.done,this.undone):this}addChanges(t,e,r,n,o){let i=this.done,l=i[i.length-1];return i=l&&l.changes&&!l.changes.empty&&t.changes&&(!r||Q.test(r))&&(!l.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(o,function(t,e){let r=[],n=!1;return t.iterChangedRanges((t,e)=>r.push(t,e)),e.iterChangedRanges((t,e,o,i)=>{for(let l=0;l<r.length;){let t=r[l++],e=r[l++];i>=t&&o<=e&&(n=!0)}}),n}(l.changes,t.changes))||"input.type.compose"==r)?G(i,i.length-1,n.minDepth,new x(t.changes.compose(l.changes),H(f.mapEffects(t.effects,l.changes),l.effects),l.mapped,l.startSelection,P)):G(i,i.length,n.minDepth,t),new X(i,P,e,r)}addSelection(t,e,r,n){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:P;return o.length>0&&e-this.prevTime<n&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&(i=o[o.length-1],l=t,i.ranges.length==l.ranges.length&&0===i.ranges.filter((t,e)=>t.empty!=l.ranges[e].empty).length)?this:new X(W(this.done,t),this.undone,e,r);var i,l}addMapping(t){return new X(q(this.done,t),q(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,r){let n=0==t?this.done:this.undone;if(0==n.length)return null;let o=n[n.length-1],i=o.selectionsAfter[0]||e.selection;if(r&&o.selectionsAfter.length)return e.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:U.of({side:t,rest:Y(n),selection:i}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let r=1==n.length?P:n.slice(0,n.length-1);return o.mapped&&(r=q(r,o.mapped)),e.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:U.of({side:t,rest:r,selection:i}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}return null}}X.empty=new X(P,P);const Z=[{key:"Mod-z",run:O,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:z,preventDefault:!0},{linux:"Ctrl-Shift-z",run:z,preventDefault:!0},{key:"Mod-u",run:J,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:$,preventDefault:!0}];function _(e,r){return t.create(e.ranges.map(r),e.mainIndex)}function tt(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function et({state:t,dispatch:e},r){let n=_(t.selection,r);return!n.eq(t.selection,!0)&&(e(tt(t,n)),!0)}function rt(e,r){return t.cursor(r?e.to:e.from)}function nt(t,e){return et(t,r=>r.empty?t.moveByChar(r,e):rt(r,e))}function ot(t){return t.textDirectionAt(t.state.selection.main.head)==d.LTR}const it=t=>nt(t,!ot(t)),lt=t=>nt(t,ot(t));function st(t,e){return et(t,r=>r.empty?t.moveByGroup(r,e):rt(r,e))}function ut(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function ft(e,r,n){let o,i,l=y(e).resolveInner(r.head),s=n?A.closedBy:A.openedBy;for(let t=r.head;;){let r=n?l.childAfter(t):l.childBefore(t);if(!r)break;ut(e,r,s)?l=r:t=n?r.to:r.from}return i=l.type.prop(s)&&(o=n?v(e,l.from,1):v(e,l.to,-1))&&o.matched?n?o.end.to:o.end.from:n?l.to:l.from,t.cursor(i,n?-1:1)}function at(t,e){return et(t,r=>{if(!r.empty)return rt(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}const ct=t=>at(t,!1),ht=t=>at(t,!0);function dt(t){let e,r=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,o=0;if(r){for(let e of t.state.facet(h.scrollMargins)){let r=e(t);(null==r?void 0:r.top)&&(n=Math.max(null==r?void 0:r.top,n)),(null==r?void 0:r.bottom)&&(o=Math.max(null==r?void 0:r.bottom,o))}e=t.scrollDOM.clientHeight-n-o}else e=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:o,selfScroll:r,height:Math.max(t.defaultLineHeight,e-5)}}function mt(t,e){let r,n=dt(t),{state:o}=t,i=_(o.selection,r=>r.empty?t.moveVertically(r,e,n.height):rt(r,e));if(i.eq(o.selection))return!1;if(n.selfScroll){let e=t.coordsAtPos(o.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),s=l.top+n.marginTop,u=l.bottom-n.marginBottom;e&&e.top>s&&e.bottom<u&&(r=h.scrollIntoView(i.main.head,{y:"start",yMargin:e.top-s}))}return t.dispatch(tt(o,i),{effects:r}),!0}const pt=t=>mt(t,!1),kt=t=>mt(t,!0);function yt(e,r,n){let o=e.lineBlockAt(r.head),i=e.moveToLineBoundary(r,n);if(i.head==r.head&&i.head!=(n?o.to:o.from)&&(i=e.moveToLineBoundary(r,n,!1)),!n&&i.head==o.from&&o.length){let n=/^\s*/.exec(e.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;n&&r.head!=o.from+n&&(i=t.cursor(o.from+n))}return i}function vt(e,r){let n=_(e.state.selection,e=>{let n=r(e);return t.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return!n.eq(e.state.selection)&&(e.dispatch(tt(e.state,n)),!0)}function wt(t,e){return vt(t,r=>t.moveByChar(r,e))}const gt=t=>wt(t,!ot(t)),At=t=>wt(t,ot(t));function Mt(t,e){return vt(t,r=>t.moveByGroup(r,e))}function Dt(t,e){return vt(t,r=>t.moveVertically(r,e))}const Ct=t=>Dt(t,!1),Et=t=>Dt(t,!0);function St(t,e){return vt(t,r=>t.moveVertically(r,e,dt(t).height))}const bt=t=>St(t,!1),It=t=>St(t,!0),Vt=({state:t,dispatch:e})=>(e(tt(t,{anchor:0})),!0),Ut=({state:t,dispatch:e})=>(e(tt(t,{anchor:t.doc.length})),!0),jt=({state:t,dispatch:e})=>(e(tt(t,{anchor:t.selection.main.anchor,head:0})),!0),Bt=({state:t,dispatch:e})=>(e(tt(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function Rt(e,r){if(e.state.readOnly)return!1;let n="delete.selection",{state:o}=e,i=o.changeByRange(o=>{let{from:i,to:l}=o;if(i==l){let t=r(o);t<i?(n="delete.backward",t=Tt(e,t,!1)):t>i&&(n="delete.forward",t=Tt(e,t,!0)),i=Math.min(i,t),l=Math.max(l,t)}else i=Tt(e,i,!1),l=Tt(e,l,!0);return i==l?{range:o}:{changes:{from:i,to:l},range:t.cursor(i,i<o.head?-1:1)}});return!i.changes.empty&&(e.dispatch(o.update(i,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?h.announce.of(o.phrase("Selection deleted")):void 0})),!0)}function Tt(t,e,r){if(t instanceof h)for(let n of t.state.facet(h.atomicRanges).map(e=>e(t)))n.between(e,e,(t,n)=>{t<e&&n>e&&(e=r?n:t)});return e}const Lt=(t,r,n)=>Rt(t,o=>{let l,s,u=o.from,{state:f}=t,a=f.doc.lineAt(u);if(n&&!r&&u>a.from&&u<a.from+200&&!/[^ \t]/.test(l=a.text.slice(0,u-a.from))){if("\t"==l[l.length-1])return u-1;let t=e(l,f.tabSize)%w(f)||w(f);for(let e=0;e<t&&" "==l[l.length-1-e];e++)u--;s=u}else s=i(a.text,u-a.from,r,r)+a.from,s==u&&a.number!=(r?f.doc.lines:1)?s+=r?1:-1:!r&&/[\ufe00-\ufe0f]/.test(a.text.slice(s-a.from,u-a.from))&&(s=i(a.text,s-a.from,!1,!1)+a.from);return s}),Nt=t=>Lt(t,!1,!0),Ot=t=>Lt(t,!0,!1),zt=(t,e)=>Rt(t,r=>{let n=r.head,{state:o}=t,l=o.doc.lineAt(n),s=o.charCategorizer(n);for(let t=null;;){if(n==(e?l.to:l.from)){n==r.head&&l.number!=(e?o.doc.lines:1)&&(n+=e?1:-1);break}let u=i(l.text,n-l.from,e)+l.from,f=l.text.slice(Math.min(n,u)-l.from,Math.max(n,u)-l.from),a=s(f);if(null!=t&&a!=t)break;" "==f&&n==r.head||(t=a),n=u}return n}),Jt=t=>zt(t,!1);function $t(t){let e=[],r=-1;for(let n of t.selection.ranges){let o=t.doc.lineAt(n.from),i=t.doc.lineAt(n.to);if(n.empty||n.to!=i.from||(i=t.doc.lineAt(n.to-1)),r>=o.number){let t=e[e.length-1];t.to=i.to,t.ranges.push(n)}else e.push({from:o.from,to:i.to,ranges:[n]});r=i.number+1}return e}function xt(e,r,n){if(e.readOnly)return!1;let o=[],i=[];for(let l of $t(e)){if(n?l.to==e.doc.length:0==l.from)continue;let r=e.doc.lineAt(n?l.to+1:l.from-1),s=r.length+1;if(n){o.push({from:l.to,to:r.to},{from:l.from,insert:r.text+e.lineBreak});for(let r of l.ranges)i.push(t.range(Math.min(e.doc.length,r.anchor+s),Math.min(e.doc.length,r.head+s)))}else{o.push({from:r.from,to:l.from},{from:l.to,insert:e.lineBreak+r.text});for(let e of l.ranges)i.push(t.range(e.anchor-s,e.head-s))}}return!!o.length&&(r(e.update({changes:o,scrollIntoView:!0,selection:t.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0)}function Gt(t,e,r){if(t.readOnly)return!1;let n=[];for(let o of $t(t))r?n.push({from:o.from,insert:t.doc.slice(o.from,o.to)+t.lineBreak}):n.push({from:o.to,insert:t.lineBreak+t.doc.slice(o.from,o.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Ht=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes($t(e).map(({from:t,to:r})=>(t>0?t--:r<e.doc.length&&r++,{from:t,to:r}))),n=_(e.selection,e=>{let r;if(t.lineWrapping){let n=t.lineBlockAt(e.head),o=t.coordsAtPos(e.head,e.assoc||1);o&&(r=n.bottom+t.documentTop-o.bottom+t.defaultLineHeight/2)}return t.moveVertically(e,!0,r)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0},Pt=Ft(!1);function Ft(n){return({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(i=>{let{from:l,to:s}=i,u=o.doc.lineAt(l),f=!n&&l==s&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r,n=y(t).resolveInner(e),o=n.childBefore(e),i=n.childAfter(e);return o&&i&&o.to<=e&&i.from>=e&&(r=o.type.prop(A.closedBy))&&r.indexOf(i.name)>-1&&t.doc.lineAt(o.to).from==t.doc.lineAt(i.from).from&&!/\S/.test(t.sliceDoc(o.to,i.from))?{from:o.to,to:i.from}:null}(o,l);n&&(l=s=(s<=u.to?u:o.doc.lineAt(s)).to);let a=new m(o,{simulateBreak:l,simulateDoubleBreak:!!f}),c=p(a,l);for(null==c&&(c=e(/^\s*/.exec(o.doc.lineAt(l).text)[0],o.tabSize));s<u.to&&/\s/.test(u.text[s-u.from]);)s++;f?({from:l,to:s}=f):l>u.from&&l<u.from+100&&!/\S/.test(u.text.slice(0,l))&&(l=u.from);let h=["",k(o,c)];return f&&h.push(k(o,a.lineIndent(u.from,-1))),{changes:{from:l,to:s,insert:r.of(h)},range:t.cursor(l+1+h[1].length)}});return i(o.update(l,{scrollIntoView:!0,userEvent:"input"})),!0}}function Wt(e,r){let n=-1;return e.changeByRange(o=>{let i=[];for(let t=o.from;t<=o.to;){let l=e.doc.lineAt(t);l.number>n&&(o.empty||o.to>l.from)&&(r(l,i,o),n=l.number),t=l.to+1}let l=e.changes(i);return{changes:i,range:t.range(l.mapPos(o.anchor,1),l.mapPos(o.head,1))}})}const Yt=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(Wt(t,(e,r)=>{r.push({from:e.from,insert:t.facet(g)})}),{userEvent:"input.indent"})),!0),qt=({state:t,dispatch:r})=>!t.readOnly&&(r(t.update(Wt(t,(r,n)=>{let o=/^\s*/.exec(r.text)[0];if(!o)return;let i=e(o,t.tabSize),l=0,s=k(t,Math.max(0,i-w(t)));for(;l<o.length&&l<s.length&&o.charCodeAt(l)==s.charCodeAt(l);)l++;n.push({from:r.from+l,to:r.from+o.length,insert:s.slice(l)})}),{userEvent:"delete.dedent"})),!0),Kt=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>et(t,e=>ft(t.state,e,!ot(t))),shift:t=>vt(t,e=>ft(t.state,e,!ot(t)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>et(t,e=>ft(t.state,e,ot(t))),shift:t=>vt(t,e=>ft(t.state,e,ot(t)))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>xt(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>Gt(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>xt(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>Gt(t,e,!0)},{key:"Escape",run:({state:e,dispatch:r})=>{let n=e.selection,o=null;return n.ranges.length>1?o=t.create([n.main]):n.main.empty||(o=t.create([t.cursor(n.main.head)])),!!o&&(r(tt(e,o)),!0)}},{key:"Mod-Enter",run:Ft(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:e,dispatch:r})=>{let n=$t(e).map(({from:r,to:n})=>t.range(r,Math.min(n+1,e.doc.length)));return r(e.update({selection:t.create(n),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:e,dispatch:r})=>{let n=_(e.selection,r=>{let n=y(e),o=n.resolveStack(r.from,1);if(r.empty){let t=n.resolveStack(r.from,-1);t.node.from>=o.node.from&&t.node.to<=o.node.to&&(o=t)}for(let e=o;e;e=e.next){let{node:n}=e;if((n.from<r.from&&n.to>=r.to||n.to>r.to&&n.from<=r.from)&&e.next)return t.range(n.to,n.from)}return r});return!n.eq(e.selection)&&(r(tt(e,n)),!0)},preventDefault:!0},{key:"Mod-[",run:qt},{key:"Mod-]",run:Yt},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new m(t,{overrideIndentation:t=>{let e=r[t];return null==e?-1:e}}),o=Wt(t,(e,o,i)=>{let l=p(n,e.from);if(null==l)return;/\S/.test(e.text)||(l=0);let s=/^\s*/.exec(e.text)[0],u=k(t,l);(s!=u||i.from<e.from+s.length)&&(r[e.from]=l,o.push({from:e.from,to:e.from+s.length,insert:u}))});return o.changes.empty||e(t.update(o,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:Ht},{key:"Shift-Mod-\\",run:({state:e,dispatch:r})=>function(e,r){let n=!1,o=_(e.selection,r=>{let o=v(e,r.head,-1)||v(e,r.head,1)||r.head>0&&v(e,r.head-1,1)||r.head<e.doc.length&&v(e,r.head+1,-1);if(!o||!o.end)return r;n=!0;let i=o.start.from==r.head?o.end.to:o.end.from;return t.cursor(i)});return!!n&&(r(tt(e,o)),!0)}(e,r)},{key:"Mod-/",run:t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=S(t.state,r.from);return n.line?D(t):!!n.block&&E(t)}},{key:"Alt-A",run:C},{key:"Ctrl-m",mac:"Shift-Alt-m",run:t=>(t.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:it,shift:gt,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>st(t,!ot(t)),shift:t=>Mt(t,!ot(t)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:t=>et(t,e=>yt(t,e,!ot(t))),shift:t=>vt(t,e=>yt(t,e,!ot(t))),preventDefault:!0},{key:"ArrowRight",run:lt,shift:At,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>st(t,ot(t)),shift:t=>Mt(t,ot(t)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:t=>et(t,e=>yt(t,e,ot(t))),shift:t=>vt(t,e=>yt(t,e,ot(t))),preventDefault:!0},{key:"ArrowUp",run:ct,shift:Ct,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Vt,shift:jt},{mac:"Ctrl-ArrowUp",run:pt,shift:bt},{key:"ArrowDown",run:ht,shift:Et,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ut,shift:Bt},{mac:"Ctrl-ArrowDown",run:kt,shift:It},{key:"PageUp",run:pt,shift:bt},{key:"PageDown",run:kt,shift:It},{key:"Home",run:t=>et(t,e=>yt(t,e,!1)),shift:t=>vt(t,e=>yt(t,e,!1)),preventDefault:!0},{key:"Mod-Home",run:Vt,shift:jt},{key:"End",run:t=>et(t,e=>yt(t,e,!0)),shift:t=>vt(t,e=>yt(t,e,!0)),preventDefault:!0},{key:"Mod-End",run:Ut,shift:Bt},{key:"Enter",run:Pt,shift:Pt},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:Nt,shift:Nt},{key:"Delete",run:Ot},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Jt},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>zt(t,!0)},{mac:"Mod-Backspace",run:t=>Rt(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)})},{mac:"Mod-Delete",run:t=>Rt(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)})}].concat([{key:"Ctrl-b",run:it,shift:gt,preventDefault:!0},{key:"Ctrl-f",run:lt,shift:At},{key:"Ctrl-p",run:ct,shift:Ct},{key:"Ctrl-n",run:ht,shift:Et},{key:"Ctrl-a",run:e=>et(e,r=>t.cursor(e.lineBlockAt(r.head).from,1)),shift:e=>vt(e,r=>t.cursor(e.lineBlockAt(r.head).from))},{key:"Ctrl-e",run:e=>et(e,r=>t.cursor(e.lineBlockAt(r.head).to,-1)),shift:e=>vt(e,r=>t.cursor(e.lineBlockAt(r.head).to))},{key:"Ctrl-d",run:Ot},{key:"Ctrl-h",run:Nt},{key:"Ctrl-k",run:t=>Rt(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)})},{key:"Ctrl-Alt-h",run:Jt},{key:"Ctrl-o",run:({state:e,dispatch:n})=>{if(e.readOnly)return!1;let o=e.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:r.of(["",""])},range:t.cursor(e.from)}));return n(e.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{if(!r.empty||0==r.from||r.from==e.doc.length)return{range:r};let n=r.from,o=e.doc.lineAt(n),l=n==o.from?n-1:i(o.text,n-o.from,!1)+o.from,s=n==o.to?n+1:i(o.text,n-o.from,!0)+o.from;return{changes:{from:l,to:s,insert:e.doc.slice(n,s).append(e.doc.slice(l,n))},range:t.cursor(s)}});return!n.changes.empty&&(r(e.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:kt}].map(t=>({mac:t.key,run:t.run,shift:t.shift})))),Qt={key:"Tab",run:Yt,shift:qt};export{L as a,Ht as b,Kt as d,Z as h,Qt as i,z as r,O as u};
